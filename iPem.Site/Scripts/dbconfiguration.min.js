(function(f){var b="IPv4\u5730\u5740\u683c\u5f0f\u9519\u8bef";var m="<strong>\u7cfb\u7edf\u63d0\u793a:</strong> \u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...";var j="<strong>\u7cfb\u7edf\u63d0\u793a:</strong> \u8bf7\u6c42\u5df2\u5b8c\u6210\uff0c\u6267\u884c\u6210\u529f\u3002";var e="<strong>\u7cfb\u7edf\u9519\u8bef:</strong> ajax\u8bf7\u6c42\u65f6\u53d1\u751f\u9519\u8bef";var h="<strong>\u7cfb\u7edf\u9519\u8bef:</strong> ajax\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u9519\u8bef";var c=200;var d={master:0,history:1,resource:2};f.ajaxSetup({type:"POST",cache:false,timeout:60000});var i=function(n,w){var r=n.find("#testbtn"),s=n.find("#savebtn"),o=n.find("#form-loading"),t=n.find("#form-error"),u=n.find("#form-ok"),q=o.children("span").eq(2),v=t.children("span").eq(2),p=u.children("span").eq(2);q.html(w||m);v.html("");p.html("");o.show();t.hide();u.hide();r.attr("disabled","disabled");s.attr("disabled","disabled")};var g=function(n,w){var r=n.find("#testbtn"),s=n.find("#savebtn"),o=n.find("#form-loading"),t=n.find("#form-error"),u=n.find("#form-ok"),q=o.children("span").eq(2),v=t.children("span").eq(2),p=u.children("span").eq(2);q.html("");v.html("");p.html(w||j);o.hide();t.hide();u.show()};var k=function(n,w){var r=n.find("#testbtn"),s=n.find("#savebtn"),o=n.find("#form-loading"),t=n.find("#form-error"),u=n.find("#form-ok"),q=o.children("span").eq(2),v=t.children("span").eq(2),p=u.children("span").eq(2);q.html("");v.html(w||e);p.html("");o.hide();t.show();u.hide()};var a=function(o){var p=o.find("#testbtn"),n=o.find("#savebtn");p.removeAttr("disabled");n.removeAttr("disabled")};var l=function(p,o,n){window.setTimeout(function(){p--;if(p>0){o.html(p);l(p,o,n)}else{location.href=n}},1000)};f(document).ready(function(){f("#rsForm").validate({rules:{IP:{ipv4:true},Port:{required:true,digits:true,max:65535,min:1}},messages:{IP:{ipv4:b}},errorElement:"span",highlight:function(n){var o=f(n).closest(".input-group");if(!o.hasClass("has-error")){o.addClass("has-error")}},errorPlacement:function(n,o){n.appendTo(o.parent().next())},success:function(n,o){var p=f(o).closest(".input-group");if(p.hasClass("has-error")){p.removeClass("has-error")}}});f("#csForm").validate({rules:{IP:{ipv4:true},Port:{required:true,digits:true,max:65535,min:1}},messages:{IP:{ipv4:b}},errorElement:"span",highlight:function(n){var o=f(n).closest(".input-group");if(!o.hasClass("has-error")){o.addClass("has-error")}},errorPlacement:function(n,o){n.appendTo(o.parent().next())},success:function(n,o){var p=f(o).closest(".input-group");if(p.hasClass("has-error")){p.removeClass("has-error")}}});f("#scForm").validate({rules:{IP:{ipv4:true},Port:{required:true,digits:true,max:65535,min:1}},messages:{IP:{ipv4:b}},errorElement:"span",highlight:function(n){var o=f(n).closest(".input-group");if(!o.hasClass("has-error")){o.addClass("has-error")}},errorPlacement:function(n,o){n.appendTo(o.parent().next())},success:function(n,o){var p=f(o).closest(".input-group");if(p.hasClass("has-error")){p.removeClass("has-error")}}});f("#confirmForm").validate({rules:{password:{required:true}},highlight:function(n){var o=f(n).closest(".input-group");if(!o.hasClass("has-error")){o.addClass("has-error")}},errorPlacement:function(n,o){},success:function(n,o){var p=f(o).closest(".input-group");if(p.hasClass("has-error")){p.removeClass("has-error")}}});f("#rsForm button[id=testbtn]").click(function(){var n=f("#rsForm");if(n.valid()){f.ajax({url:"/Installation/DbTest",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#rsForm button[id=savebtn]").click(function(){var n=f("#rsForm");if(n.valid()){f.ajax({url:"/Installation/SaveRs",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#csForm button[id=testbtn]").click(function(){var n=f("#csForm");if(n.valid()){f.ajax({url:"/Installation/DbTest",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#csForm button[id=savebtn]").click(function(){var n=f("#csForm");if(n.valid()){f.ajax({url:"/Installation/SaveCs",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#scForm button[id=testbtn]").click(function(){var n=f("#scForm");if(n.valid()){f.ajax({url:"/Installation/DbTest",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#scForm button[id=savebtn]").click(function(){var n=f("#scForm");if(n.valid()){f.ajax({url:"/Installation/SaveSc",data:n.serializeArray(),dataType:"json",beforeSend:function(o){i(n)},success:function(q,r,p){try{if(typeof q.code==="undefined"||typeof q.message==="undefined"){throw new Error(h)}if(q.code==c){g(n,q.message)}else{throw new Error(q.message)}}catch(o){k(n,o.message)}}}).always(function(){a(n)})}});f("#cleanForm button[id=deletebtn]").click(function(){var n=f("#confirmForm");n[0].reset()});f("#confirmForm button[id=cleanbtn]").click(function(){var n=f("#cleanForm"),o=f("#confirmForm"),v=n.find("#deletebtn"),p=n.find("#form-loading"),s=n.find("#form-error"),t=n.find("#form-ok"),r=p.children("span").eq(2),u=s.children("span").eq(2),q=t.children("span").eq(2);if(o.valid()){f.ajax({url:"/Installation/DbClean",data:o.serializeArray(),dataType:"json",beforeSend:function(w){r.html(m);u.html("");q.html("");p.show();s.hide();t.hide();v.attr("disabled","disabled");f("#confirmModal").modal("hide")},success:function(y,z,x){try{if(typeof y.code==="undefined"||typeof y.message==="undefined"){throw new Error(h)}if(y.code==c){r.html("");u.html("");q.html(y.message);p.hide();s.hide();t.show();l(5,n.find("#leftseconds"),"/Installation")}else{throw new Error(y.message)}}catch(w){r.html("");u.html(w.message);q.html("");p.hide();s.show();t.hide()}}}).always(function(){v.removeAttr("disabled")})}})})})(jQuery);
