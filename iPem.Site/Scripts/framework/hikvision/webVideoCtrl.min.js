/*! WebVideoCtrl.js - 2017-10-31 */

!function(a){if(!a.WebVideoCtrl){var b=function(){function b(){this.id=this.createUUID()}var d="100%",e="100%",f="",g="",h={szContainerID:"",szColorProperty:"",szOcxClassId:"clsid:FDF0038A-CF64-4634-81AB-80F0A7946D6C",szMimeTypes:"application/webvideo-plugin-kit",iWndowType:1,iPlayMode:2,bWndFull:!0,bDebugMode:!1,cbSelWnd:null,cbEvent:null},i=null,j=0,k=[],l=[],m=null,n=null,o=null,p=null,q=this,r=null;a.GetSelectWndInfo=function(a){var b=p.loadXML(a);j=parseInt(c.$XML(b).find("SelectWnd").eq(0).text(),10);var d=[];d.push("<RealPlayInfo>"),d.push("<SelectWnd>"+j+"</SelectWnd>"),d.push("</RealPlayInfo>"),h.cbSelWnd&&h.cbSelWnd(p.loadXML(d.join("")))},a.ZoomInfoCallback=function(a){var b=q.findWndIndexByIndex(j);if(-1!=b){var c=l[b];if(-1!=(b=q.findDeviceIndexByIP(c.szIP))){var d=k[b];d.oProtocolInc.set3DZoom(d,c,a,{success:function(a){},error:function(){}})}}},a.PluginEventHandler=function(a,b,c){s("插件事件：PluginEventHandler iEventType：%s iParam1: %s, iParam2: %s",a,b,c),0==a||2==a?q.I_Stop(b):21==a?q.I_StopRecord(b):3==a&&q.I_StopVoiceTalk(),h.cbEvent&&h.cbEvent(a,b,c)},a.GetHttpInfo=function(a,b,c){s("http响应返回：http状态：%s, http数据：%s",a,b),J.prototype.processCallback(a,b)};var s=function(){if(h.bDebugMode){var a=t(arguments);m._alert(a)}},t=function(){for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace("%s",arguments[b]);return a},u=function(a){return void 0===a},v=function(){var a="";if(p.browser().msie)a="<object classid='"+h.szOcxClassId+"' codebase='' standby='Waiting...' id='"+f+"' width='"+d+"' height='"+e+"' align='center' ><param name='wndtype' value='"+h.iWndowType+"'><param name='playmode' value='"+h.iPlayMode+"'><param name='colors' value='"+h.szColorProperty+"'></object>";else for(var b=navigator.mimeTypes.length,c=0;c<b;c++)navigator.mimeTypes[c].type.toLowerCase()==h.szMimeTypes&&(a="<embed align='center' type='"+h.szMimeTypes+"' width='"+d+"' height='"+e+"' name='"+g+"' wndtype='"+h.iWndowType+"' playmode='"+h.iPlayMode+"' colors='"+h.szColorProperty+"'>");return a},w=function(){var a=i.HWP_GetLocalConfig();r=p.loadXML(a)},x=function(a){q.I_GetDeviceInfo(a.szIP,{success:function(b){a.szDeviceType=c.$XML(b).find("deviceType").eq(0).text()}}),q.I_GetAnalogChannelInfo(a.szIP,{success:function(b){a.iAnalogChannelNum=c.$XML(b).find("VideoInputChannel",!0).length}}),q.I_GetAudioInfo(a.szIP,{success:function(b){var d=c.$XML(b).find("audioCompressionType",!0);if(d.length>0){var e=c.$XML(d).eq(0).text(),f=0;"G.711ulaw"==e?f=1:"G.711alaw"==e?f=2:"G.726"==e&&(f=3),a.iAudioType=f}}})},y=function(){var a=h.bWndFull?1:0;i.HWP_SetCanFullScreen(a)},z=function(a){var b=null;if(D(a))b=A(a),b.iRtspPort,b.iDevicePort;else{for(var c=C(a),d=!1,e=0;e<c.length;e++)if(c[e].ipv4==a.szIP||c[e].ipv6==a.szIP){d=!0;break}d?b=A(a):(b=B(a),-1==b.iRtspPort&&-1==b.iDevicePort&&(b=A(a))),b.iRtspPort,b.iHttpPort,b.iDevicePort}return b},A=function(a){var b=-1,d=-1,e=-1;return a.oProtocolInc.getPortInfo(a,{async:!1,success:function(a){var f=c.$XML(a).find("AdminAccessProtocol",!0);b=554;for(var g=0,h=f.length;g<h;g++)"rtsp"===c.$XML(f).eq(g).find("protocol").eq(0).text().toLowerCase()&&(b=parseInt(c.$XML(f).eq(g).find("portNo").eq(0).text(),10)),"http"===c.$XML(f).eq(g).find("protocol").eq(0).text().toLowerCase()&&(d=parseInt(c.$XML(f).eq(g).find("portNo").eq(0).text(),10)),"dev_manage"===c.$XML(f).eq(g).find("protocol").eq(0).text().toLowerCase()&&(e=parseInt(c.$XML(f).eq(g).find("portNo").eq(0).text(),10))},error:function(){b=-1,d=-1,e=-1}}),{iRtspPort:b,iHttpPort:d,iDevicePort:e}},B=function(a){var b=-1,d=-1,e=-1;return a.oProtocolInc.getUPnPPortStatus(a,{async:!1,success:function(a){for(var f=c.$XML(a).find("portStatus",!0),g=0,h=f.length;g<h;g++)"rtsp"==c.$XML(f).eq(g).find("internalPort").eq(0).text().toLowerCase()&&(b=parseInt(c.$XML(f).eq(g).find("externalPort").eq(0).text(),10)),"http"==c.$XML(f).eq(g).find("internalPort").eq(0).text().toLowerCase()&&(d=parseInt(c.$XML(f).eq(g).find("externalPort").eq(0).text(),10)),"admin"==c.$XML(f).eq(g).find("internalPort").eq(0).text().toLowerCase()&&(e=parseInt(c.$XML(f).eq(g).find("externalPort").eq(0).text(),10))},error:function(){b=-1,d=-1,e=-1}}),{iRtspPort:b,iHttpPort:d,iDevicePort:e}},C=function(a){var b=[];return a.oProtocolInc.getNetworkBond(a,{async:!1,success:function(d){"true"==c.$XML(d).find("enabled").eq(0).text()?b.push({ipv4:c.$XML(d).find("ipAddress").eq(0).text(),ipv6:c.$XML(d).find("ipv6Address").eq(0).text()}):a.oProtocolInc.getNetworkInterface(a,{async:!1,success:function(a){for(var d=c.$XML(a).find("NetworkInterface",!0),e=0,f=d.length;e<f;e++){b.push({ipv4:c.$XML(a).find("ipAddress").eq(0).text(),ipv6:c.$XML(a).find("ipv6Address").eq(0).text()});break}},error:function(){}})},error:function(){a.oProtocolInc.getNetworkInterface(a,{async:!1,success:function(a){for(var d=c.$XML(a).find("NetworkInterface",!0),e=0,f=d.length;e<f;e++){b.push({ipv4:c.$XML(a).find("ipAddress").eq(0).text(),ipv6:c.$XML(a).find("ipv6Address").eq(0).text()});break}},error:function(){}})}}),b},D=function(a){var b=!1;return a.oProtocolInc.getPPPoEStatus(a,{async:!1,success:function(a){b=c.$XML(a).find("ipAddress",!0).length>0||c.$XML(a).find("ipv6Address",!0).length>0},error:function(){b=!1}}),b},E=function(a){a.oStreamCapa.bObtained||a.oProtocolInc instanceof K&&("IPCamera"==a.szDeviceType||"IPDome"==a.szDeviceType||"IPZoom"==a.szDeviceType?a.oProtocolInc.getStreamChannels(a,{async:!1,success:function(b){a.oStreamCapa.bObtained=!0;for(var c=$(b).find("streamingTransport",!0).length,d=0;d<c;d++)if("shttp"==$(b).find("streamingTransport").eq(d).text().toLowerCase()){a.oStreamCapa.bObtained=!0,a.oStreamCapa.bSupportShttpPlay=!0,a.oStreamCapa.bSupportShttpPlayback=!0,a.oStreamCapa.bSupportShttpsPlay=!0,a.oStreamCapa.bSupportShttpsPlayback=!0,a.oStreamCapa.iIpChanBase=1;break}},error:function(){}}):a.oProtocolInc.getSDKCapa(a,{async:!1,success:function(b){a.oStreamCapa.bObtained=!0,a.oStreamCapa.bSupportShttpPlay="true"===c.$XML(b).find("isSupportHttpPlay").eq(0).text(),a.oStreamCapa.bSupportShttpPlayback="true"===c.$XML(b).find("isSupportHttpPlayback").eq(0).text(),a.oStreamCapa.bSupportShttpsPlay="true"===c.$XML(b).find("isSupportHttpsPlay").eq(0).text(),a.oStreamCapa.bSupportShttpsPlayback="true"===c.$XML(b).find("isSupportHttpsPlayback").eq(0).text(),a.oStreamCapa.bSupportShttpPlaybackTransCode="true"===c.$XML(b).find("isSupportHttpTransCodePlayback").eq(0).text(),a.oStreamCapa.bSupportShttpsPlaybackTransCode="true"===c.$XML(b).find("isSupportHttpsTransCodePlayback").eq(0).text(),c.$XML(b).find("ipChanBase",!0).length>0&&(a.oStreamCapa.iIpChanBase=parseInt(c.$XML(b).find("ipChanBase").eq(0).text(),10))},error:function(){a.oStreamCapa.bObtained=!0}}))},F=function(a){var b={TransFrameRate:"",TransResolution:"",TransBitrate:""};if(p.extend(b,a),""==b.TransFrameRate||""==b.TransResolution||""==b.TransBitrate)return"";var c=[];return c.push("<?xml version='1.0' encoding='UTF-8'?>"),c.push("<CompressionInfo>"),c.push("<TransFrameRate>"+b.TransFrameRate+"</TransFrameRate>"),c.push("<TransResolution>"+b.TransResolution+"</TransResolution>"),c.push("<TransBitrate>"+b.TransBitrate+"</TransBitrate>"),c.push("</CompressionInfo>"),c.join("")};this.I_InitPlugin=function(a,b,c){d=a,e=b,p.extend(h,c)},this.I_InsertOBJECTPlugin=function(b){return u(b)||(h.szContainerID=b),null==document.getElementById(h.szContainerID)?-1:null!=document.getElementById(f)||0!=document.getElementsByName(f).length?-1:(document.getElementById(h.szContainerID).innerHTML=v(),null==(i=p.browser().msie?document.getElementById(f):document.getElementsByName(g)[0])&&null==i.object?-1:("object"==typeof a.attachEvent&&p.browser().msie&&(i.attachEvent("GetSelectWndInfo",GetSelectWndInfo),i.attachEvent("ZoomInfoCallback",ZoomInfoCallback),i.attachEvent("GetHttpInfo",GetHttpInfo),i.attachEvent("PluginEventHandler",PluginEventHandler)),w(),0))},this.I_WriteOBJECT_XHTML=function(){return document.writeln(v()),null==(i=p.browser().msie?document.getElementById(f):document.getElementsByName(g)[0])&&null==i.object?-1:(p.browser().msie&&(i.attachEvent("GetSelectWndInfo",GetSelectWndInfo),i.attachEvent("ZoomInfoCallback",ZoomInfoCallback),i.attachEvent("GetHttpInfo",GetHttpInfo),i.attachEvent("PluginEventHandler",PluginEventHandler)),w(),0)},this.I_OpenFileDlg=function(a){var b=i.HWP_OpenFileBrowser(a,"");if(null==b)return"";if(1==a){if(b.length>100)return-1}else if(b.length>130)return-1;return b},this.I_GetLocalCfg=function(){var a=i.HWP_GetLocalConfig(),b=[];return r=p.loadXML(a),b.push("<LocalConfigInfo>"),b.push("<ProtocolType>"+c.$XML(r).find("ProtocolType").eq(0).text()+"</ProtocolType>"),b.push("<PackgeSize>"+c.$XML(r).find("PackgeSize").eq(0).text()+"</PackgeSize>"),b.push("<PlayWndType>"+c.$XML(r).find("PlayWndType").eq(0).text()+"</PlayWndType>"),b.push("<BuffNumberType>"+c.$XML(r).find("BuffNumberType").eq(0).text()+"</BuffNumberType>"),b.push("<RecordPath>"+c.$XML(r).find("RecordPath").eq(0).text()+"</RecordPath>"),b.push("<CapturePath>"+c.$XML(r).find("CapturePath").eq(0).text()+"</CapturePath>"),b.push("<PlaybackFilePath>"+c.$XML(r).find("PlaybackFilePath").eq(0).text()+"</PlaybackFilePath>"),b.push("<PlaybackPicPath>"+c.$XML(r).find("PlaybackPicPath").eq(0).text()+"</PlaybackPicPath>"),b.push("<DownloadPath>"+c.$XML(r).find("DownloadPath").eq(0).text()+"</DownloadPath>"),b.push("<IVSMode>"+c.$XML(r).find("IVSMode").eq(0).text()+"</IVSMode>"),b.push("<CaptureFileFormat>"+c.$XML(r).find("CaptureFileFormat").eq(0).text()+"</CaptureFileFormat>"),b.push("</LocalConfigInfo>"),p.loadXML(b.join(""))},this.I_SetLocalCfg=function(a){var b=p.loadXML(a),d=-1;return c.$XML(r).find("ProtocolType").eq(0).text(c.$XML(b).find("ProtocolType").eq(0).text()),c.$XML(r).find("PackgeSize").eq(0).text(c.$XML(b).find("PackgeSize").eq(0).text()),c.$XML(r).find("PlayWndType").eq(0).text(c.$XML(b).find("PlayWndType").eq(0).text()),c.$XML(r).find("BuffNumberType").eq(0).text(c.$XML(b).find("BuffNumberType").eq(0).text()),c.$XML(r).find("RecordPath").eq(0).text(c.$XML(b).find("RecordPath").eq(0).text()),c.$XML(r).find("CapturePath").eq(0).text(c.$XML(b).find("CapturePath").eq(0).text()),c.$XML(r).find("PlaybackFilePath").eq(0).text(c.$XML(b).find("PlaybackFilePath").eq(0).text()),c.$XML(r).find("PlaybackPicPath").eq(0).text(c.$XML(b).find("PlaybackPicPath").eq(0).text()),c.$XML(r).find("DownloadPath").eq(0).text(c.$XML(b).find("DownloadPath").eq(0).text()),c.$XML(r).find("IVSMode").eq(0).text(c.$XML(b).find("IVSMode").eq(0).text()),c.$XML(r).find("CaptureFileFormat").eq(0).text(c.$XML(b).find("CaptureFileFormat").eq(0).text()),d=i.HWP_SetLocalConfig(p.toXMLStr(r)),d?0:-1};var G=function(a,b,c,d,e,f,g){var h={protocol:b,success:null,error:null};p.extend(h,g),p.extend(h,{success:function(h){var i=new H;i.szIP=a,2==b?(i.szHttpProtocol="https://",i.iHttpsPort=c):(i.szHttpProtocol="http://",i.iHttpPort=c),i.iCGIPort=c,i.szAuth=d,i.iDeviceProtocol=e,i.oProtocolInc=f,k.push(i),s("使用%s协议登录成功",e),x(i),y(),g.success&&g.success(h)},error:function(a,b){g.error&&g.error(a,b)}}),f.login(a,c,d,h)};this.I_Login=function(a,b,c,d,e,f){if(-1!=this.findDeviceIndexByIP(a))return s("设备已经登录过"),-1;var g=n,h=1;u(f.cgi)||(1==f.cgi?(g=n,h=1):(g=o,h=2));var i="";if(1==h){i=p.Base64.encode(":"+d+":"+e);var j={success:null,error:null};p.extend(j,f),p.extend(j,{error:function(j,k){i=p.Base64.encode(d+":"+e),h=1,g=n;var l={success:null,error:null};p.extend(l,f),p.extend(l,{error:function(){if(!u(f.cgi))return void(f.error&&f.error(j,k));i=p.Base64.encode(":"+d+":"+e),h=2,g=o;var l={success:null,error:null};p.extend(l,f),p.extend(l,{error:function(j,k){i=p.Base64.encode(d+":"+e),h=2,g=o;var l={success:null,error:null};p.extend(l,f),p.extend(l,{error:function(){f.error&&f.error(j,k)}}),G(a,b,c,i,h,g,l)}}),G(a,b,c,i,h,g,l)}}),G(a,b,c,i,h,g,l)}}),G(a,b,c,i,h,g,j)}else{i=p.Base64.encode(":"+d+":"+e),h=2,g=o;var j={success:null,error:null};p.extend(j,f),p.extend(j,{error:function(j,k){i=p.Base64.encode(d+":"+e),h=2,g=o;var l={success:null,error:null};p.extend(l,f),p.extend(l,{error:function(){f.error&&f.error(j,k)}}),G(a,b,c,i,h,g,l)}}),G(a,b,c,i,h,g,j)}},this.I_Logout=function(a){var b=this.findDeviceIndexByIP(a);return-1!=b?(k.splice(b,1),0):-1},this.I_GetAudioInfo=function(a,b){var c=this.findDeviceIndexByIP(a);if(-1!=c){var d=k[c],e={success:null,error:null};p.extend(e,b),d.oProtocolInc.getAudioInfo(d,e)}},this.I_GetDeviceInfo=function(a,b){var c=this.findDeviceIndexByIP(a);if(-1!=c){var d=k[c],e={success:null,error:null};p.extend(e,b),d.oProtocolInc.getDeviceInfo(d,e)}},this.I_GetAnalogChannelInfo=function(a,b){var c=this.findDeviceIndexByIP(a);if(-1!=c){var d=k[c],e={success:null,error:null};p.extend(e,b),d.oProtocolInc.getAnalogChannelInfo(d,e)}},this.I_GetDigitalChannelInfo=function(a,b){var c=this.findDeviceIndexByIP(a);if(-1!=c){var d=k[c],e={success:null,error:null};p.extend(e,b),d.oProtocolInc.getDigitalChannelInfo(d,e)}},this.I_GetZeroChannelInfo=function(a,b){var c=this.findDeviceIndexByIP(a);if(-1!=c){var d=k[c],e={success:null,error:null};p.extend(e,b),d.oProtocolInc.getZeroChannelInfo(d,e)}},this.I_StartRealPlay=function(a,b){var d=this.findDeviceIndexByIP(a),e=-1,f="",g="",h=-1,i=0,m=0,n=!1,o={iWndIndex:j,iStreamType:1,iChannelID:1,bZeroChannel:!1};if(p.extend(o,b),-1!=d){E(k[d]);var q=k[d];if(0==parseInt(c.$XML(r).find("ProtocolType").eq(0).text(),10)&&q.oStreamCapa.bSupportShttpPlay?(s("SHTTP RealPlay"),f=q.oProtocolInc.CGI.startShttpRealPlay,g="http://",m=o.iStreamType-1,i=o.iChannelID<=q.iAnalogChannelNum?o.iChannelID:q.oStreamCapa.iIpChanBase+parseInt(o.iChannelID,10)-q.iAnalogChannelNum-1,n=!0,u(o.iPort)?"https://"==q.szHttpProtocol?(-1==q.iHttpPort&&(q.iHttpPort=z(q).iHttpPort),h=q.iHttpPort):h=q.iCGIPort:(q.iHttpPort=o.iPort,h=o.iPort)):(s("RTSP RealPlay"),f=q.oProtocolInc.CGI.startRealPlay,g="rtsp://",m=o.iStreamType,i=o.iChannelID,u(o.iPort)||(q.iRtspPort=o.iPort),-1==q.iRtspPort&&(q.iRtspPort=z(q).iRtspPort),h=q.iRtspPort),-1==h)return s("获取端口号失败"),e;if(p.extend(o,{urlProtocol:g,cgi:f,iPort:h,iStreamType:m,iChannelID:i}),d=this.findWndIndexByIndex(o.iWndIndex),-1==d&&(e=q.oProtocolInc.startRealPlay(q,o)),-1==e)q.iRtspPort=-1;else{d=this.findWndIndexByIndex(o.iWndIndex);l[d].bShttpIPChannel=n}}return e},this.I_Stop=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.bRecord&&i.HWP_StopSave(d.iIndex),d.bSound&&i.HWP_CloseSound(),d.bEZoom&&i.HWP_DisableZoom(d.iIndex),c=i.HWP_Stop(a),0==c&&l.splice(b,1)}return c},this.I_OpenSound=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.bSound||0==(c=i.HWP_OpenSound(a))&&(d.bSound=!0)}return c},this.I_CloseSound=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.bSound&&0==(c=i.HWP_CloseSound())&&(d.bSound=!1)}return c},this.I_SetVolume=function(a,b){var c=-1;return isNaN(parseInt(a,10))?c:(b=u(b)?j:b,-1!=this.findWndIndexByIndex(b)&&(c=i.HWP_SetVolume(b,a)),c)},this.I_CapturePic=function(a,b){b=u(b)?j:b;var c=this.findWndIndexByIndex(b),d=-1;return-1!=c&&(d=i.HWP_CapturePicture(b,a)),d},this.I_StartRecord=function(a,b){b=u(b)?j:b;var c=this.findWndIndexByIndex(b),d=-1;if(-1!=c){var e=l[c];e.bRecord||0==(d=i.HWP_StartSave(b,a))&&(e.bRecord=!0)}return d},this.I_StopRecord=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.bRecord&&0==(c=i.HWP_StopSave(a))&&(d.bRecord=!1)}return c},this.I_StartVoiceTalk=function(a,b){if(isNaN(parseInt(b,10)))return-1;var c=this.findDeviceIndexByIP(a),d=-1;if(-1!=c){var e=k[c];e.bVoiceTalk||0==(d=e.oProtocolInc.startVoiceTalk(e,b))&&(k[c].bVoiceTalk=!0)}return d},this.I_StopVoiceTalk=function(){for(var a=i.HWP_StopVoiceTalk(),b=0,c=k.length;b<c;b++)if(k[b].bVoiceTalk){k[b].bVoiceTalk=!1;break}return a},this.I_PTZControl=function(a,b,c){var d={iWndIndex:j,iPTZIndex:a,iPTZSpeed:4};p.extend(d,c),p.extend(d,{async:!1});var e=this.findWndIndexByIndex(d.iWndIndex);if(-1!=e){var f=l[e];if(-1!=(e=this.findDeviceIndexByIP(f.szIP))){var g=k[e];9==a?g.oProtocolInc.ptzAutoControl(g,b,f,d):g.oProtocolInc.ptzControl(g,b,f,d)}}},this.I_EnableEZoom=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.bEZoom||0==(c=i.HWP_EnableZoom(a,0))&&(d.bEZoom=!0)}return c},this.I_DisableEZoom=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a);if(-1!=b){var c=l[b];if(c.bEZoom)return i.HWP_DisableZoom(a),c.bEZoom=!1,0}return-1},this.I_Enable3DZoom=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b];d.b3DZoom||0==(c=i.HWP_EnableZoom(a,1))&&(d.b3DZoom=!0)}return c},this.I_Disable3DZoom=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a);if(-1!=b){var c=l[b];if(c.b3DZoom)return i.HWP_DisableZoom(a),c.b3DZoom=!1,0}return-1},this.I_FullScreen=function(a){i.HWP_FullScreenDisplay(a)},this.I_SetPreset=function(a,b){var c={iWndIndex:j,iPresetID:a};p.extend(c,b);var d=this.findWndIndexByIndex(c.iWndIndex);if(-1!=d){var e=l[d];if(-1!=(d=this.findDeviceIndexByIP(e.szIP))){var f=k[d];f.oProtocolInc.setPreset(f,e,c)}}},this.I_GoPreset=function(a,b){var c={iWndIndex:j,iPresetID:a};p.extend(c,b);var d=this.findWndIndexByIndex(c.iWndIndex);if(-1!=d){var e=l[d];if(-1!=(d=this.findDeviceIndexByIP(e.szIP))){var f=k[d];f.oProtocolInc.goPreset(f,e,c)}}},this.I_RecordSearch=function(a,b,c,d,e){var f=this.findDeviceIndexByIP(a);if(-1!=f){var g=k[f],h={iChannelID:b,szStartTime:c,szEndTime:d,iSearchPos:0,success:null,error:null};p.extend(h,e),g.oProtocolInc.recordSearch(g,h)}},this.I_StartPlayback=function(a,b){var d=this.findDeviceIndexByIP(a),e=-1,f="",g="",h=-1,i=1,l=p.dateFormat(new Date,"yyyy-MM-dd"),m={iWndIndex:j,iChannelID:1,szStartTime:l+" 00:00:00",szEndTime:l+" 23:59:59"};if(p.extend(m,b),-1!=d){E(k[d]);var n=k[d];if(0==parseInt(c.$XML(r).find("ProtocolType").eq(0).text(),10)&&n.oStreamCapa.bSupportShttpPlay?(f=u(m.oTransCodeParam)?n.oProtocolInc.CGI.startShttpPlayback:n.oProtocolInc.CGI.startTransCodePlayback,g="http://",i=m.iChannelID<=n.iAnalogChannelNum?m.iChannelID:n.oStreamCapa.iIpChanBase+parseInt(m.iChannelID,10)-n.iAnalogChannelNum-1,u(m.iPort)?"https://"==n.szHttpProtocol?(-1==n.iHttpPort&&(n.iHttpPort=z(n).iHttpPort),h=n.iHttpPort):h=n.iCGIPort:(n.iHttpPort=m.iPort,h=m.iPort)):(f=n.oProtocolInc.CGI.startPlayback,g="rtsp://",i=100*m.iChannelID+1,u(m.iPort)||(n.iRtspPort=m.iPort),-1==n.iRtspPort&&(n.iRtspPort=z(n).iRtspPort),h=n.iRtspPort),-1==h)return s("获取端口号失败"),e;p.extend(m,{urlProtocol:g,cgi:f,iPort:h,iChannelID:i}),d=this.findWndIndexByIndex(m.iWndIndex),-1==d&&(m.szStartTime=m.szStartTime.replace(/[-:]/g,"").replace(" ","T")+"Z",m.szEndTime=m.szEndTime.replace(/[-:]/g,"").replace(" ","T")+"Z",e=n.oProtocolInc.startPlayback(n,m)),-1==e&&(n.iRtspPort=-1)}return e},this.I_ReversePlayback=function(a,b){var d=this.findDeviceIndexByIP(a),e=-1,f="",g="",h=-1,i=-1,l=p.dateFormat(new Date,"yyyy-MM-dd"),m={iWndIndex:j,iChannelID:1,bZeroChannel:!1,szStartTime:l+" 00:00:00",szEndTime:l+" 23:59:59"};if(p.extend(m,b),-1!=d){E(k[d]);var n=k[d];if(0==parseInt(c.$XML(r).find("ProtocolType").eq(0).text(),10)&&n.oStreamCapa.bSupportShttpPlay?(f=n.oProtocolInc.CGI.startShttpReversePlayback,g="http://",i=m.iChannelID<=n.iAnalogChannelNum?m.iChannelID:n.oStreamCapa.iIpChanBase+parseInt(m.iChannelID,10)-n.iAnalogChannelNum-1,u(m.iPort)?"https://"==n.szHttpProtocol?(-1==n.iHttpPort&&(n.iHttpPort=z(n).iHttpPort),h=n.iHttpPort):h=n.iCGIPort:(n.iHttpPort=m.iPort,h=m.iPort)):(f=n.oProtocolInc.CGI.startPlayback,g="rtsp://",i=100*m.iChannelID+1,u(m.iPort)||(n.iRtspPort=m.iPort),-1==n.iRtspPort&&(n.iRtspPort=z(n).iRtspPort),h=n.iRtspPort),-1==h)return s("获取端口号失败"),e;p.extend(m,{urlProtocol:g,cgi:f,iPort:h,iChannelID:i}),d=this.findWndIndexByIndex(m.iWndIndex),-1==d&&(m.szStartTime=m.szStartTime.replace(/[-:]/g,"").replace(" ","T")+"Z",m.szEndTime=m.szEndTime.replace(/[-:]/g,"").replace(" ","T")+"Z",e=n.oProtocolInc.reversePlayback(n,m))}return-1==e&&(n.iRtspPort=-1),e},this.I_Frame=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b],e=d.iPlayStatus;2!=e&&4!=e||0==(c=i.HWP_FrameForward(a))&&(d.iPlayStatus=4)}return c},this.I_Pause=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b],e=d.iPlayStatus;2==e?0==(c=i.HWP_Pause(a))&&(d.iPlayStatus=3):5==e&&0==(c=i.HWP_Pause(a))&&(d.iPlayStatus=6)}return c},this.I_Resume=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){var d=l[b],e=d.iPlayStatus;3==e||4==e?0==(c=i.HWP_Resume(a))&&(d.iPlayStatus=2):6==e&&0==(c=i.HWP_Resume(a))&&(d.iPlayStatus=5)}return c},this.I_PlaySlow=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){2==l[b].iPlayStatus&&(c=i.HWP_Slow(a))}return c},this.I_PlayFast=function(a){a=u(a)?j:a;var b=this.findWndIndexByIndex(a),c=-1;if(-1!=b){2==l[b].iPlayStatus&&(c=i.HWP_Fast(a))}return c},this.I_GetOSDTime=function(a){a=u(a)?j:a;if(-1!=this.findWndIndexByIndex(a)){var b=i.HWP_GetOSDTime(a);return p.dateFormat(new Date(1e3*b),"yyyy-MM-dd hh:mm:ss")}return-1},this.I_StartDownloadRecord=function(a,b,c){var d=this.findDeviceIndexByIP(a),e=-1;if(-1!=d){var f=k[d],g={szPlaybackURI:b,szFileName:c};e=f.oProtocolInc.startDownloadRecord(f,g)}return e},this.I_GetDownloadStatus=function(a){var b=i.HWP_GetDownloadStatus(a);return 1==b&&(b=-1),b},this.I_GetDownloadProgress=function(a){return i.HWP_GetDownloadProgress(a)},this.I_StopDownloadRecord=function(a){return i.HWP_StopDownload(a)},this.I_ExportDeviceConfig=function(a){var b=this.findDeviceIndexByIP(a),c=-1;if(-1!=b){var d=k[b];c=d.oProtocolInc.exportDeviceConfig(d)}return c},this.I_ImportDeviceConfig=function(a,b){var c=this.findDeviceIndexByIP(a),d=-1;if(-1!=c){var e=k[c],f={szFileName:b};d=e.oProtocolInc.importDeviceConfig(e,f)}return d},this.I_RestoreDefault=function(a,b,c){var d={success:null,error:null};p.extend(d,c);var e=this.findDeviceIndexByIP(a);if(-1!=e){var f=k[e];f.oProtocolInc.restore(f,b,d)}},this.I_Restart=function(a,b){var c=this.findDeviceIndexByIP(a),d={success:null,error:null};if(p.extend(d,b),-1!=c){var e=k[c];e.oProtocolInc.restart(e,d)}},this.I_Reconnect=function(a,b){var c=this.findDeviceIndexByIP(a),d={success:null,error:null};if(p.extend(d,b),-1!=c){var e=k[c];e.oProtocolInc.login(e.szIP,e.iCGIPort,e.szAuth,d)}},this.I_StartUpgrade=function(a,b){var c=this.findDeviceIndexByIP(a),d=-1;if(-1!=c){var e=k[c],f={szFileName:b};d=e.oProtocolInc.startUpgrade(e,f)}return d},this.I_UpgradeStatus=function(){return i.HWP_UpgradeStatus()},this.I_UpgradeProgress=function(){return i.HWP_UpgradeProgress()},this.I_StopUpgrade=function(){return i.HWP_StopUpgrade()},this.I_CheckPluginInstall=function(){var a=-1,b=p.browser();if(b.chrome&&parseInt(b.version,10)>45)return-2;if(b.msie)try{new ActiveXObject("WebVideoKitActiveX.WebVideoKitActiveXCtrl.1");a=0}catch(a){}else for(var c=0,d=navigator.mimeTypes.length;c<d;c++)if("application/webvideo-plugin-kit"==navigator.mimeTypes[c].type.toLowerCase()){a=0;break}return a},this.I_CheckPluginVersion=function(){return i.HWP_CheckPluginUpdate("<?xml version='1.0' encoding='utf-8'?><FileVersion><Platform name='win32'><npWebVideoKitPlugin.dll>3,0,6,1</npWebVideoKitPlugin.dll><WebVideoKitActiveX.ocx>3,0,6,1</WebVideoKitActiveX.ocx><PlayCtrl.dll>7,3,0,81</PlayCtrl.dll><StreamTransClient.dll>1,1,3,5</StreamTransClient.dll><SystemTransform.dll>2,5,1,7</SystemTransform.dll><NetStream.dll>1,0,5,59</NetStream.dll></Platform></FileVersion>")?-1:0},this.I_SendHTTPRequest=function(a,b,c){var d=this.findDeviceIndexByIP(a);if(!(d<0)){var e=k[d],f=new J,g=e.szHttpProtocol+e.szIP+":"+e.iCGIPort+"/"+b,h={type:"GET",url:g,auth:e.szAuth,success:null,error:null};p.extend(h,c),p.extend(h,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),f.setRequestParam(h),f.submitRequest()}},this.I_RemoteConfig=function(a,b){var c=this.findDeviceIndexByIP(a),d=-1,e={iLan:0,iDevicePort:-1,iType:0};if(p.extend(e,b),-1!=c){var f=k[c];if(-1==e.iDevicePort)if(-1==f.iDevicePort){if(f.iDevicePort=z(f).iDevicePort,-1==(d=f.iDevicePort))return-1}else d=f.iDevicePort;else d=e.iDevicePort;if(":"==p.Base64.decode(f.szAuth)[0])var g=p.Base64.decode(f.szAuth).split(":")[1],h=p.Base64.decode(f.szAuth).split(":")[2];else var g=p.Base64.decode(f.szAuth).split(":")[0],h=p.Base64.decode(f.szAuth).split(":")[1];var j="<RemoteInfo><DeviceInfo><DeviceType>"+e.iType+"</DeviceType><LanType>"+e.iLan+"</LanType><IP>"+a+"</IP><Port>"+d+"</Port><UName>"+g+"</UName><PWD>"+p.Base64.encode(h)+"</PWD></DeviceInfo></RemoteInfo>";return i.HWP_ShowRemConfig(j)}return-1},this.I_ChangeWndNum=function(a){return isNaN(parseInt(a,10))?-1:(i.HWP_ArrangeWindow(a),0)},this.I_GetLastError=function(){return i.HWP_GetLastError()},this.I_GetWindowStatus=function(a){if(u(a)){var b=[];return p.extend(b,l),b}var c=this.findWndIndexByIndex(a);if(-1!=c){var b={};return p.extend(b,l[c]),b}return null},this.I_GetIPInfoByMode=function(a,b,c,d){return i.HWP_GetIpInfoByMode(a,b,c,d)},this.findDeviceIndexByIP=function(a){for(var b=0;b<k.length;b++)if(k[b].szIP==a)return b;return-1},this.findWndIndexByIndex=function(a){for(var b=0;b<l.length;b++)if(l[b].iIndex==a)return b;return-1};var H=function(){this.szIP="",this.szHostName="",this.szAuth="",this.szHttpProtocol="http://",this.iCGIPort=80,this.iDevicePort=-1,this.iHttpPort=-1,this.iHttpsPort=-1,this.iRtspPort=-1,this.iAudioType=1,this.iDeviceProtocol=1,this.oProtocolInc=null,this.iAnalogChannelNum=0,this.szDeviceType="",this.bVoiceTalk=!1,this.oStreamCapa={bObtained:!1,bSupportShttpPlay:!1,bSupportShttpPlayback:!1,bSupportShttpsPlay:!1,bSupportShttpsPlayback:!1,bSupportShttpPlaybackTransCode:!1,bSupportShttpsPlaybackTransCode:!1,iIpChanBase:1}},I=function(){this.iIndex=0,this.szIP="",this.iChannelID="",this.iPlayStatus=0,this.bSound=!1,this.bRecord=!1,this.bPTZAuto=!1,this.bEZoom=!1,this.b3DZoom=!1},J=function(){this.options={type:"GET",url:"",auth:"",timeout:1e4,data:"",async:!0,success:null,error:null},this.m_szHttpHead="",this.m_szHttpContent="",this.m_szHttpData=""};J.prototype.m_httpRequestSet=[],J.prototype.setRequestParam=function(a){p.extend(this.options,a)},J.prototype.submitRequest=function(){var a=this.getHttpMethod(this.options.type),b=null;if(this.options.async){var c=i.HWP_SubmitHttpRequest(a,this.options.url,this.options.auth,this.options.data,this.options.timeout);-1!=c&&(b={iRequestID:c,funSuccessCallback:this.options.success,funErrorCallback:this.options.error},this.m_httpRequestSet.push(b))}else{var d=i.HWP_SendHttpSynRequest(a,this.options.url,this.options.auth,this.options.data,this.options.timeout);b={funSuccessCallback:this.options.success,funErrorCallback:this.options.error},this.httpDataAnalyse(b,d)}},J.prototype.getHttpMethod=function(a){var b={GET:1,POST:2,PUT:5,DELETE:6},c=b[a];return c||-1},J.prototype.processCallback=function(a,b){for(var c=null,d=0;d<this.m_httpRequestSet.length;d++)if(a==this.m_httpRequestSet[d].iRequestID){c=this.m_httpRequestSet[d],this.m_httpRequestSet.splice(d,1);break}null!=c&&(this.httpDataAnalyse(c,b),delete c)},J.prototype.httpDataAnalyse=function(a,b){var c="",d=0;""==b||u(b)?a.funErrorCallback():(d=parseInt(b.substring(0,3)),c=b.substring(3,b.length),isNaN(d)?a.funErrorCallback():200==d?a.funSuccessCallback(p.loadXML(c)):a.funErrorCallback(d,p.loadXML(c)))};var K=function(){};K.prototype.CGI={login:"%s%s:%s/ISAPI/Security/userCheck",getAudioInfo:"%s%s:%s/ISAPI/System/TwoWayAudio/channels",getDeviceInfo:"%s%s:%s/ISAPI/System/deviceInfo",getAnalogChannelInfo:"%s%s:%s/ISAPI/System/Video/inputs/channels",getDigitalChannel:"%s%s:%s/ISAPI/ContentMgmt/InputProxy/channels",getDigitalChannelInfo:"%s%s:%s/ISAPI/ContentMgmt/InputProxy/channels/status",getZeroChannelInfo:"%s%s:%s/ISAPI/ContentMgmt/ZeroVideo/channels",getStreamChannels:{analog:"%s%s:%s/ISAPI/Streaming/channels",digital:"%s%s:%s/ISAPI/ContentMgmt/StreamingProxy/channels"},getStreamDynChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels",startRealPlay:{channels:"%s%s:%s/PSIA/streaming/channels/%s",zeroChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroStreaming/channels/%s"},startShttpRealPlay:{channels:"%s%s:%s/SDK/play/%s/004",zeroChannels:"%s%s:%s/SDK/play/100/004/ZeroStreaming"},startVoiceTalk:{open:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/open",close:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/close",audioData:"%s%s:%s/ISAPI/System/TwoWayAudio/channels/%s/audioData"},ptzControl:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/continuous",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/continuous"},ptzAutoControl:{ipdome:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s/goto",analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/autoPan",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/autoPan"},setPreset:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/presets/%s"},goPreset:{analog:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/presets/%s/goto",digital:"%s%s:%s/ISAPI/ContentMgmt/PTZCtrlProxy/channels/%s/presets/%s/goto"},ptzFocus:{analog:"%s%s:%s/ISAPI/Image/channels/%s/focus",digital:"%s%s:%s/ISAPI/ContentMgmt/ImageProxy/channels/%s/focus",ipc:"%s%s:%s/ISAPI/System/Video/inputs/channels/%s/focus"},ptzIris:{analog:"%s%s:%s/ISAPI/Image/channels/%s/iris",digital:"%s%s:%s/ISAPI/ContentMgmt/ImageProxy/channels/%s/iris",ipc:"%s%s:%s/ISAPI/System/Video/inputs/channels/%s/iris"},getNetworkBond:"%s%s:%s/ISAPI/System/Network/Bond",getNetworkInterface:"%s%s:%s/ISAPI/System/Network/interfaces",getUPnPPortStatus:"%s%s:%s/ISAPI/System/Network/UPnP/ports/status",getPPPoEStatus:"%s%s:%s/ISAPI/System/Network/PPPoE/1/status",getPortInfo:"%s%s:%s/ISAPI/Security/adminAccesses",recordSearch:"%s%s:%s/ISAPI/ContentMgmt/search",startPlayback:"%s%s:%s/PSIA/streaming/tracks/%s?starttime=%s&endtime=%s",startShttpPlayback:"%s%s:%s/SDK/playback/%s",startShttpReversePlayback:"%s%s:%s/SDK/playback/%s/reversePlay",startTransCodePlayback:"%s%s:%s/SDK/playback/%s/transcoding",startDownloadRecord:"%s%s:%s/ISAPI/ContentMgmt/download",deviceConfig:"%s%s:%s/ISAPI/System/configurationData",restart:"%s%s:%s/ISAPI/System/reboot",restore:"%s%s:%s/ISAPI/System/factoryReset?mode=%s",startUpgrade:{upgrade:"%s%s:%s/ISAPI/System/updateFirmware",status:"%s%s:%s/ISAPI/System/upgradeStatus"},set3DZoom:"%s%s:%s/ISAPI/PTZCtrl/channels/%s/position3D",SDKCapabilities:"%s%s:%s/SDK/capabilities"},K.prototype.login=function(a,b,d,e){var f=2==e.protocol?"https://":"http://",g=t(this.CGI.login,f,a,b),h=new J,i={type:"GET",url:g,auth:d,success:null,error:null};p.extend(i,e),p.extend(i,{success:function(a){"200"==c.$XML(a).find("statusValue").eq(0).text()||"OK"==c.$XML(a).find("statusString").eq(0).text()?e.success&&e.success(a):e.error&&e.error(401,a)},error:function(a,b){e.error&&e.error(a,b)}}),h.setRequestParam(i),h.submitRequest()},K.prototype.getAudioInfo=function(a,b){var c=t(this.CGI.getAudioInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getDeviceInfo=function(a,b){var d=t(this.CGI.getDeviceInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<DeviceInfo>"),d.push("<deviceName>"+p.escape(c.$XML(a).find("deviceName").eq(0).text())+"</deviceName>"),d.push("<deviceID>"+c.$XML(a).find("deviceID").eq(0).text()+"</deviceID>"),d.push("<deviceType>"+c.$XML(a).find("deviceType").eq(0).text()+"</deviceType>"),d.push("<model>"+c.$XML(a).find("model").eq(0).text()+"</model>"),d.push("<serialNumber>"+c.$XML(a).find("serialNumber").eq(0).text()+"</serialNumber>"),d.push("<macAddress>"+c.$XML(a).find("macAddress").eq(0).text()+"</macAddress>"),d.push("<firmwareVersion>"+c.$XML(a).find("firmwareVersion").eq(0).text()+"</firmwareVersion>"),d.push("<firmwareReleasedDate>"+c.$XML(a).find("firmwareReleasedDate").eq(0).text()+"</firmwareReleasedDate>"),d.push("<encoderVersion>"+c.$XML(a).find("encoderVersion").eq(0).text()+"</encoderVersion>"),d.push("<encoderReleasedDate>"+c.$XML(a).find("encoderReleasedDate").eq(0).text()+"</encoderReleasedDate>"),d.push("</DeviceInfo>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},K.prototype.getAnalogChannelInfo=function(a,b){var d=t(this.CGI.getAnalogChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<VideoInputChannelList>");for(var e=c.$XML(a).find("VideoInputChannel",!0),f=0,g=e.length;f<g;f++){var h=e[f];d.push("<VideoInputChannel>"),d.push("<id>"+c.$XML(h).find("id").eq(0).text()+"</id>"),d.push("<inputPort>"+c.$XML(h).find("inputPort").eq(0).text()+"</inputPort>"),d.push("<name>"+p.escape(c.$XML(h).find("name").eq(0).text())+"</name>"),d.push("<videoFormat>"+c.$XML(h).find("videoFormat").eq(0).text()+"</videoFormat>"),d.push("</VideoInputChannel>")}d.push("</VideoInputChannelList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},K.prototype.getDigitalChannel=function(a,b){var d=t(this.CGI.getDigitalChannel,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<InputProxyChannelList>");for(var e=c.$XML(a).find("InputProxyChannel",!0),f=0,g=e.length;f<g;f++){var h=e[f];d.push("<InputProxyChannel>"),d.push("<id>"+c.$XML(h).find("id").eq(0).text()+"</id>"),d.push("<name>"+p.escape(c.$XML(h).find("name").eq(0).text())+"</name>"),d.push("</InputProxyChannel>")}d.push("</InputProxyChannelList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},K.prototype.getDigitalChannelInfo=function(a,b){var d=null,e={};if(this.getDigitalChannel(a,{async:!1,success:function(a){d=a;for(var b=c.$XML(d).find("InputProxyChannel",!0),f=0,g=b.length;f<g;f++){var h=b[f],i=c.$XML(h).find("id").eq(0).text(),j=c.$XML(h).find("name").eq(0).text();e[i]=j}},error:function(a,c){b.error&&b.error(a,c)}}),null!==d){var f=t(this.CGI.getDigitalChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),g=new J,h={type:"GET",url:f,auth:a.szAuth,success:null,error:null};p.extend(h,b),p.extend(h,{success:function(a){var d=[];d.push("<InputProxyChannelStatusList>");for(var f=c.$XML(a).find("InputProxyChannelStatus",!0),g=0,h=f.length;g<h;g++){var i=f[g],j=c.$XML(i).find("id").eq(0).text();d.push("<InputProxyChannelStatus>"),d.push("<id>"+j+"</id>"),d.push("<sourceInputPortDescriptor>"),d.push("<proxyProtocol>"+c.$XML(i).find("proxyProtocol").eq(0).text()+"</proxyProtocol>"),d.push("<addressingFormatType>"+c.$XML(i).find("addressingFormatType").eq(0).text()+"</addressingFormatType>"),d.push("<ipAddress>"+c.$XML(i).find("ipAddress").eq(0).text()+"</ipAddress>"),d.push("<managePortNo>"+c.$XML(i).find("managePortNo").eq(0).text()+"</managePortNo>"),d.push("<srcInputPort>"+c.$XML(i).find("srcInputPort").eq(0).text()+"</srcInputPort>"),d.push("<userName>"+p.escape(c.$XML(i).find("userName").eq(0).text())+"</userName>"),d.push("<streamType>"+c.$XML(i).find("streamType").eq(0).text()+"</streamType>"),d.push("<online>"+c.$XML(i).find("online").eq(0).text()+"</online>"),d.push("<name>"+p.escape(e[j])+"</name>"),d.push("</sourceInputPortDescriptor>"),d.push("</InputProxyChannelStatus>")}d.push("</InputProxyChannelStatusList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),g.setRequestParam(h),g.submitRequest()}},K.prototype.getZeroChannelInfo=function(a,b){var c=t(this.CGI.getZeroChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getStreamChannels=function(a,b){if(0!=a.iAnalogChannelNum)var c=t(this.CGI.getStreamChannels.analog,a.szHttpProtocol,a.szIP,a.iCGIPort);else var c=t(this.CGI.getStreamChannels.digital,a.szHttpProtocol,a.szIP,a.iCGIPort);var d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getPPPoEStatus=function(a,b){var c=t(this.CGI.getPPPoEStatus,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getUPnPPortStatus=function(a,b){var c=t(this.CGI.getUPnPPortStatus,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getNetworkBond=function(a,b){var c=t(this.CGI.getNetworkBond,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getNetworkInterface=function(a,b){var c=t(this.CGI.getNetworkInterface,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.getPortInfo=function(a,b){var c=t(this.CGI.getPortInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.startRealPlay=function(a,b){var c=100*b.iChannelID+b.iStreamType,d="";d=b.bZeroChannel?t(b.cgi.zeroChannels,b.urlProtocol,a.szIP,b.iPort,c):t(b.cgi.channels,b.urlProtocol,a.szIP,b.iPort,c);var e=i.HWP_Play(d,a.szAuth,b.iWndIndex,"","");if(0==e){var f=new I;f.iIndex=b.iWndIndex,f.szIP=a.szIP,f.iChannelID=b.iChannelID,f.iPlayStatus=1,l.push(f)}return e},K.prototype.startVoiceTalk=function(a,b){var c=t(this.CGI.startVoiceTalk.open,a.szHttpProtocol,a.szIP,a.iCGIPort,b),d=t(this.CGI.startVoiceTalk.close,a.szHttpProtocol,a.szIP,a.iCGIPort,b),e=t(this.CGI.startVoiceTalk.audioData,a.szHttpProtocol,a.szIP,a.iCGIPort,b);return i.HWP_StartVoiceTalk(c,d,e,a.szAuth,a.iAudioType)},K.prototype.ptzAutoControl=function(a,b,c,d){var e=c.iChannelID,f="",g="";if(d.iPTZSpeed=d.iPTZSpeed<7?15*d.iPTZSpeed:100,b&&(d.iPTZSpeed=0),"IPDome"!=a.szDeviceType)f=e<=a.iAnalogChannelNum?t(this.CGI.ptzAutoControl.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID):c.bShttpIPChannel?t(this.CGI.ptzAutoControl.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum):t(this.CGI.ptzAutoControl.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID),g="<?xml version='1.0' encoding='UTF-8'?><autoPanData><autoPan>"+d.iPTZSpeed+"</autoPan></autoPanData>";else{var h=99;b&&(h=96),f=t(this.CGI.ptzAutoControl.ipdome,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID,h)}var i=new J,j={type:"PUT",url:f,async:!1,auth:a.szAuth,data:g,success:null,error:null},k=this;p.extend(j,d),p.extend(j,{success:function(a){c.bPTZAuto=!c.bPTZAuto,d.success&&d.success(a)},error:function(b,e){if("IPCamera"==a.szDeviceType||"IPZoom"==a.szDeviceType){f=c.bShttpIPChannel?t(k.CGI.ptzControl.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum):t(k.CGI.ptzControl.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID),g="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+d.iPTZSpeed+"</pan><tilt>0</tilt></PTZData>";var h=new J,i={type:"PUT",url:f,async:!1,auth:a.szAuth,data:g,success:null,error:null};p.extend(i,d),h.setRequestParam(i),h.submitRequest()}else d.error&&d.error(b,e)}}),i.setRequestParam(j),i.submitRequest()},K.prototype.ptzControl=function(a,b,c,d){var e=c.iChannelID,f="";c.bPTZAuto&&this.ptzAutoControl(a,!0,c,{iPTZSpeed:0}),d.iPTZSpeed=b?0:d.iPTZSpeed<7?15*d.iPTZSpeed:100;var g=[{},{pan:0,tilt:d.iPTZSpeed},{pan:0,tilt:-d.iPTZSpeed},{pan:-d.iPTZSpeed,tilt:0},{pan:d.iPTZSpeed,tilt:0},{pan:-d.iPTZSpeed,tilt:d.iPTZSpeed},{pan:-d.iPTZSpeed,tilt:-d.iPTZSpeed},{pan:d.iPTZSpeed,tilt:d.iPTZSpeed},{pan:d.iPTZSpeed,tilt:-d.iPTZSpeed},{},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed}],h="",i={};switch(d.iPTZIndex){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:i=this.CGI.ptzControl,h="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+g[d.iPTZIndex].pan+"</pan><tilt>"+g[d.iPTZIndex].tilt+"</tilt></PTZData>";break;case 10:case 11:i=this.CGI.ptzControl,h="<?xml version='1.0' encoding='UTF-8'?><PTZData><zoom>"+g[d.iPTZIndex].speed+"</zoom></PTZData>";break;case 12:case 13:i=this.CGI.ptzFocus,h="<?xml version='1.0' encoding='UTF-8'?><FocusData><focus>"+g[d.iPTZIndex].speed+"</focus></FocusData>";break;case 14:case 15:i=this.CGI.ptzIris,h="<?xml version='1.0' encoding='UTF-8'?><IrisData><iris>"+g[d.iPTZIndex].speed+"</iris></IrisData>";break;default:return void(u(d.error)&&d.error())}f=i!=this.CGI.ptzFocus&&i!=this.CGI.ptzIris||"IPCamera"!=a.szDeviceType&&"IPDome"!=a.szDeviceType&&"IPZoom"!=a.szDeviceType?e<=a.iAnalogChannelNum?t(i.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID):c.bShttpIPChannel?t(i.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum):t(i.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID):t(i.ipc,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID);var j=new J,k={type:"PUT",url:f,async:!1,auth:a.szAuth,data:h,success:null,error:null};p.extend(k,d),p.extend(k,{success:function(a){d.success&&d.success(a)},error:function(a,b){d.error&&d.error(a,b)}}),j.setRequestParam(k),j.submitRequest()},K.prototype.setPreset=function(a,b,c){var d=b.iChannelID,e="",f="";e=d<=a.iAnalogChannelNum?t(this.CGI.setPreset.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID):b.bShttpIPChannel?t(this.CGI.setPreset.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum,c.iPresetID):t(this.CGI.setPreset.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID),f="<?xml version='1.0' encoding='UTF-8'?>",f+="<PTZPreset>",f+="<id>"+c.iPresetID+"</id>","IPDome"!=a.szDeviceType&&(f+="<presetName>Preset"+c.iPresetID+"</presetName>"),f+="</PTZPreset>";var g=new J,h={type:"PUT",url:e,auth:a.szAuth,data:f,success:null,error:null};p.extend(h,c),p.extend(h,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),g.setRequestParam(h),g.submitRequest()},K.prototype.goPreset=function(a,b,c){var d=b.iChannelID,e="";e=d<=a.iAnalogChannelNum?t(this.CGI.goPreset.analog,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID):b.bShttpIPChannel?t(this.CGI.goPreset.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum,c.iPresetID):t(this.CGI.goPreset.digital,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID);var f=new J,g={type:"PUT",url:e,auth:a.szAuth,success:null,error:null};p.extend(g,c),p.extend(g,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),f.setRequestParam(g),f.submitRequest()},K.prototype.recordSearch=function(a,d){var e="",f="",g=d.iChannelID,h=d.szStartTime.replace(" ","T")+"Z",i=d.szEndTime.replace(" ","T")+"Z";e=t(this.CGI.recordSearch,a.szHttpProtocol,a.szIP,a.iCGIPort),f="<?xml version='1.0' encoding='UTF-8'?><CMSearchDescription><searchID>"+new b+"</searchID><trackList><trackID>"+(100*g+1)+"</trackID></trackList><timeSpanList><timeSpan><startTime>"+h+"</startTime><endTime>"+i+"</endTime></timeSpan></timeSpanList><maxResults>40</maxResults><searchResultPostion>"+d.iSearchPos+"</searchResultPostion><metadataList><metadataDescriptor>//metadata.ISAPI.org/VideoMotion</metadataDescriptor></metadataList></CMSearchDescription>";var j=new J,k={type:"POST",url:e,auth:a.szAuth,data:f,success:null,error:null};p.extend(k,d),p.extend(k,{success:function(a){var b=[];b.push("<CMSearchResult>"),b.push("<responseStatus>"+c.$XML(a).find("responseStatus").eq(0).text()+"</responseStatus>"),b.push("<responseStatusStrg>"+c.$XML(a).find("responseStatusStrg").eq(0).text()+"</responseStatusStrg>"),b.push("<numOfMatches>"+c.$XML(a).find("numOfMatches").eq(0).text()+"</numOfMatches>"),b.push("<matchList>");for(var e=c.$XML(a).find("searchMatchItem",!0),f=0,g=e.length;f<g;f++){var h=e[f];b.push("<searchMatchItem>"),b.push("<trackID>"+c.$XML(h).find("trackID").eq(0).text()+"</trackID>"),b.push("<startTime>"+c.$XML(h).find("startTime").eq(0).text()+"</startTime>"),b.push("<endTime>"+c.$XML(h).find("endTime").eq(0).text()+"</endTime>"),b.push("<playbackURI>"+p.escape(c.$XML(h).find("playbackURI").eq(0).text())+"</playbackURI>"),b.push("<metadataDescriptor>"+c.$XML(h).find("metadataDescriptor").eq(0).text().split("/")[1]+"</metadataDescriptor>"),b.push("</searchMatchItem>")}b.push("</matchList>"),b.push("</CMSearchResult>"),a=p.loadXML(b.join("")),d.success&&d.success(a)},error:function(a,b){d.error&&d.error(a,b)}}),j.setRequestParam(k),j.submitRequest()},K.prototype.startPlayback=function(a,b){var c=b.iWndIndex,d=b.szStartTime,e=b.szEndTime,f=t(b.cgi,b.urlProtocol,a.szIP,b.iPort,b.iChannelID,d,e);if(!u(b.oTransCodeParam)){var g=F(b.oTransCodeParam);if(""==g)return-1;i.HWP_SetTrsPlayBackParam(c,g)}var h=i.HWP_Play(f,a.szAuth,c,d,e);if(0==h){var j=new I;j.iIndex=c,j.szIP=a.szIP,j.iChannelID=b.iChannelID,j.iPlayStatus=2,l.push(j)}return h},K.prototype.reversePlayback=function(a,b){var c=b.iWndIndex,d=b.szStartTime,e=b.szEndTime,f=t(b.cgi,b.urlProtocol,a.szIP,b.iPort,b.iChannelID,d,e),g=i.HWP_ReversePlay(f,a.szAuth,c,d,e);if(0==g){var h=new I;h.iIndex=c,h.szIP=a.szIP,h.iChannelID=b.iChannelID,h.iPlayStatus=5,l.push(h)}return g},K.prototype.startDownloadRecord=function(a,b){var c=t(this.CGI.startDownloadRecord,a.szHttpProtocol,a.szIP,a.iCGIPort),d="<?xml version='1.0' encoding='UTF-8'?><downloadRequest><playbackURI> "+p.escape(b.szPlaybackURI)+"</playbackURI></downloadRequest>";return i.HWP_StartDownload(c,a.szAuth,b.szFileName,d)},K.prototype.exportDeviceConfig=function(a){var b=t(this.CGI.deviceConfig,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_ExportDeviceConfig(b,a.szAuth,"",0)},K.prototype.importDeviceConfig=function(a,b){var c=t(this.CGI.deviceConfig,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_ImportDeviceConfig(c,a.szAuth,b.szFileName,0)},K.prototype.restart=function(a,b){var c=t(this.CGI.restart,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"PUT",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},K.prototype.restore=function(a,b,c){var d=t(this.CGI.restore,a.szHttpProtocol,a.szIP,a.iCGIPort,b),e=new J,f={type:"PUT",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,c),p.extend(f,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),e.setRequestParam(f),e.submitRequest()},K.prototype.startUpgrade=function(a,b){var c=t(this.CGI.startUpgrade.upgrade,a.szHttpProtocol,a.szIP,a.iCGIPort),d=t(this.CGI.startUpgrade.status,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_StartUpgrade(c,d,a.szAuth,b.szFileName)},K.prototype.set3DZoom=function(a,b,d,e){var f=b.iChannelID,g="";g=f<=a.iAnalogChannelNum?t(this.CGI.set3DZoom,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID):b.bShttpIPChannel?t(this.CGI.set3DZoom,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID-a.oStreamCapa.iIpChanBase+1+a.iAnalogChannelNum):t(this.CGI.set3DZoom,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID);var h=p.loadXML(d),i=parseInt(c.$XML(h).find("StartPoint").eq(0).find("positionX").eq(0).text(),10),j=parseInt(c.$XML(h).find("StartPoint").eq(0).find("positionY").eq(0).text(),10),k=parseInt(c.$XML(h).find("EndPoint").eq(0).find("positionX").eq(0).text(),10),l=parseInt(c.$XML(h).find("EndPoint").eq(0).find("positionY").eq(0).text(),10),m="<?xml version='1.0' encoding='UTF-8'?><position3D><StartPoint><positionX>"+i+"</positionX><positionY>"+(255-j)+"</positionY></StartPoint><EndPoint><positionX>"+k+"</positionX><positionY>"+(255-l)+"</positionY></EndPoint></position3D>",n=new J,o={type:"PUT",url:g,data:m,auth:a.szAuth,success:null,error:null};p.extend(o,e),p.extend(o,{success:function(a){e.success&&e.success(a)},error:function(a,b){e.error&&e.error(a,b)}}),n.setRequestParam(o),n.submitRequest()},K.prototype.getSDKCapa=function(a,b){var c=t(this.CGI.SDKCapabilities,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()};var L=function(){};L.prototype.CGI={login:"%s%s:%s/PSIA/Custom/SelfExt/userCheck",getAudioInfo:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels",getDeviceInfo:"%s%s:%s/PSIA/System/deviceInfo",getAnalogChannelInfo:"%s%s:%s/PSIA/System/Video/inputs/channels",getDigitalChannel:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynVideo/inputs/channels",getDigitalChannelInfo:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynVideo/inputs/channels/status",getZeroChannelInfo:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroVideo/channels",getStreamChannels:{analog:"%s%s:%s/PSIA/Streaming/channels",digital:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels"},getStreamDynChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/DynStreaming/channels",startRealPlay:{channels:"%s%s:%s/PSIA/streaming/channels/%s",zeroChannels:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/ZeroStreaming/channels/%s"},startVoiceTalk:{open:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/open",close:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/close",audioData:"%s%s:%s/PSIA/Custom/SelfExt/TwoWayAudio/channels/%s/audioData"},ptzControl:"%s%s:%s/PSIA/PTZ/channels/%s/continuous",ptzAutoControl:"%s%s:%s/PSIA/Custom/SelfExt/PTZ/channels/%s/autoptz",setPreset:"%s%s:%s/PSIA/PTZ/channels/%s/presets/%s",goPreset:"%s%s:%s/PSIA/PTZ/channels/%s/presets/%s/goto",ptzFocus:"%s%s:%s/PSIA/System/Video/inputs/channels/%s/focus",ptzIris:"%s%s:%s/PSIA/System/Video/inputs/channels/%s/iris",getNetworkBond:"%s%s:%s/PSIA/Custom/SelfExt/Bond",getNetworkInterface:"%s%s:%s/PSIA/System/Network/interfaces",getUPnPPortStatus:"%s%s:%s/PSIA/Custom/SelfExt/UPnP/ports/status",getPPPoEStatus:"%s%s:%s/PSIA/Custom/SelfExt/PPPoE/1/status",getPortInfo:"%s%s:%s/PSIA/Security/AAA/adminAccesses",recordSearch:"%s%s:%s/PSIA/ContentMgmt/search",startPlayback:"%s%s:%s/PSIA/streaming/tracks/%s?starttime=%s&endtime=%s",startDownloadRecord:"%s%s:%s/PSIA/Custom/SelfExt/ContentMgmt/download",deviceConfig:"%s%s:%s/PSIA/System/configurationData",restart:"%s%s:%s/PSIA/System/reboot",restore:"%s%s:%s/PSIA/System/factoryReset?mode=%s",startUpgrade:{upgrade:"%s%s:%s/PSIA/System/updateFirmware",status:"%s%s:%s/PSIA/Custom/SelfExt/upgradeStatus"},set3DZoom:"%s%s:%s/PSIA/Custom/SelfExt/PTZ/channels/%s/Set3DZoom"},L.prototype.login=function(a,b,d,e){var f=2==e.protocol?"https://":"http://",g=t(this.CGI.login,f,a,b),h=new J,i={type:"GET",url:g,auth:d,success:null,error:null};p.extend(i,e),p.extend(i,{success:function(a){"200"==c.$XML(a).find("statusValue").eq(0).text()?e.success&&e.success(a):e.error&&e.error(401,a)},error:function(a,b){e.error&&e.error(a,b)}}),h.setRequestParam(i),h.submitRequest()},L.prototype.getAudioInfo=function(a,b){var c=t(this.CGI.getAudioInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getDeviceInfo=function(a,b){var d=t(this.CGI.getDeviceInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<DeviceInfo>"),d.push("<deviceName>"+p.escape(c.$XML(a).find("deviceName").eq(0).text())+"</deviceName>"),d.push("<deviceID>"+c.$XML(a).find("deviceID").eq(0).text()+"</deviceID>"),d.push("<deviceType>"+c.$XML(a).find("deviceDescription").eq(0).text()+"</deviceType>"),d.push("<model>"+c.$XML(a).find("model").eq(0).text()+"</model>"),d.push("<serialNumber>"+c.$XML(a).find("serialNumber").eq(0).text()+"</serialNumber>"),d.push("<macAddress>"+c.$XML(a).find("macAddress").eq(0).text()+"</macAddress>"),d.push("<firmwareVersion>"+c.$XML(a).find("firmwareVersion").eq(0).text()+"</firmwareVersion>"),d.push("<firmwareReleasedDate>"+c.$XML(a).find("firmwareReleasedDate").eq(0).text()+"</firmwareReleasedDate>"),d.push("<encoderVersion>"+c.$XML(a).find("logicVersion").eq(0).text()+"</encoderVersion>"),d.push("<encoderReleasedDate>"+c.$XML(a).find("logicReleasedDate").eq(0).text()+"</encoderReleasedDate>"),d.push("</DeviceInfo>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},L.prototype.getAnalogChannelInfo=function(a,b){var d=t(this.CGI.getAnalogChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<VideoInputChannelList>");for(var e=c.$XML(a).find("VideoInputChannel",!0),f=0,g=e.length;f<g;f++){var h=e[f];d.push("<VideoInputChannel>"),d.push("<id>"+c.$XML(h).find("id").eq(0).text()+"</id>"),d.push("<inputPort>"+c.$XML(h).find("inputPort").eq(0).text()+"</inputPort>"),d.push("<name>"+p.escape(c.$XML(h).find("name").eq(0).text())+"</name>"),d.push("<videoFormat>"+c.$XML(h).find("videoFormat").eq(0).text()+"</videoFormat>"),d.push("</VideoInputChannel>")}d.push("</VideoInputChannelList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},L.prototype.getDigitalChannel=function(a,b){var d=t(this.CGI.getDigitalChannel,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(a){var d=[];d.push("<InputProxyChannelList>");for(var e=c.$XML(a).find("DynVideoInputChannel",!0),f=0,g=e.length;f<g;f++){var h=e[f];d.push("<InputProxyChannel>"),d.push("<id>"+c.$XML(h).find("id").eq(0).text()+"</id>"),d.push("<name>"+p.escape(c.$XML(h).find("name").eq(0).text())+"</name>"),d.push("</InputProxyChannel>")}d.push("</InputProxyChannelList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),e.setRequestParam(f),e.submitRequest()},L.prototype.getDigitalChannelInfo=function(a,b){var d=null,e={};if(this.getDigitalChannel(a,{async:!1,success:function(a){d=a;for(var b=c.$XML(d).find("InputProxyChannel",!0),f=0,g=b.length;f<g;f++){var h=b[f],i=c.$XML(h).find("id").eq(0).text(),j=c.$XML(h).find("name").eq(0).text();e[i]=j}},error:function(a,c){b.error&&b.error(a,c)}}),null!==d){var f=t(this.CGI.getDigitalChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),g=new J,h={type:"GET",url:f,auth:a.szAuth,success:null,error:null};p.extend(h,b),p.extend(h,{success:function(a){var d=[];d.push("<InputProxyChannelStatusList>");for(var f=c.$XML(a).find("DynVideoInputChannelStatus",!0),g=0,h=f.length;g<h;g++){var i=f[g],j=c.$XML(i).find("id").eq(0).text();d.push("<InputProxyChannelStatus>"),d.push("<id>"+j+"</id>"),d.push("<sourceInputPortDescriptor>"),d.push("<proxyProtocol>"+c.$XML(i).find("adminProtocol").eq(0).text()+"</proxyProtocol>"),d.push("<addressingFormatType>"+c.$XML(i).find("addressingFormatType").eq(0).text()+"</addressingFormatType>"),d.push("<ipAddress>"+c.$XML(i).find("ipAddress").eq(0).text()+"</ipAddress>"),d.push("<managePortNo>"+c.$XML(i).find("adminPortNo").eq(0).text()+"</managePortNo>"),d.push("<srcInputPort>"+c.$XML(i).find("srcInputPort").eq(0).text()+"</srcInputPort>"),d.push("<userName>"+p.escape(c.$XML(i).find("userName").eq(0).text())+"</userName>"),d.push("<streamType>"+c.$XML(i).find("streamType").eq(0).text()+"</streamType>"),d.push("<online>"+c.$XML(i).find("online").eq(0).text()+"</online>"),d.push("<name>"+p.escape(e[j])+"</name>"),d.push("</sourceInputPortDescriptor>"),d.push("</InputProxyChannelStatus>")}d.push("</InputProxyChannelStatusList>"),a=p.loadXML(d.join("")),b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),g.setRequestParam(h),g.submitRequest()}},L.prototype.getZeroChannelInfo=function(a,b){var c=t(this.CGI.getZeroChannelInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getPPPoEStatus=function(a,b){var c=t(this.CGI.getPPPoEStatus,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getUPnPPortStatus=function(a,b){var c=t(this.CGI.getUPnPPortStatus,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getNetworkBond=function(a,b){var c=t(this.CGI.getNetworkBond,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getNetworkInterface=function(a,b){var c=t(this.CGI.getNetworkInterface,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getPortInfo=function(a,b){var d=t(this.CGI.getPortInfo,a.szHttpProtocol,a.szIP,a.iCGIPort),e=new J,f={type:"GET",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,b),p.extend(f,{success:function(d){var e=[];e.push("<AdminAccessProtocolList>");for(var f=c.$XML(d).find("AdminAccessProtocol",!0),g=0,h=f.length;g<h;g++){f[g];e.push("<AdminAccessProtocol>"),e.push("<id>"+c.$XML(d).find("id").eq(0).text()+"</id>"),e.push("<enabled>"+c.$XML(d).find("enabled").eq(0).text()+"</enabled>"),e.push("<protocol>"+c.$XML(d).find("protocol").eq(0).text().toUpperCase()+"</protocol>"),e.push("<portNo>"+c.$XML(d).find("portNo").eq(0).text()+"</portNo>"),e.push("</AdminAccessProtocol>")}o.getStreamChannels(a,{async:!1,success:function(d){if(c.$XML(d).find("rtspPortNo",!0).length>0){var f=parseInt(c.$XML(d).find("rtspPortNo").eq(0).text(),10);e.push("<AdminAccessProtocol>"),e.push("<id>4</id>"),e.push("<enabled>true</enabled>"),e.push("<protocol>RTSP</protocol>"),e.push("<portNo>"+f+"</portNo>"),e.push("</AdminAccessProtocol>"),e.push("</AdminAccessProtocolList>");var g=p.loadXML(e.join(""));b.success&&b.success(g)}else o.getStreamDynChannels(a,{async:!1,success:function(a){if(c.$XML(a).find("rtspPortNo",!0).length>0){var d=parseInt(c.$XML(a).find("rtspPortNo").eq(0).text(),10);e.push("<AdminAccessProtocol>"),e.push("<id>4</id>"),e.push("<enabled>true</enabled>"),e.push("<protocol>RTSP</protocol>"),e.push("<portNo>"+d+"</portNo>"),e.push("</AdminAccessProtocol>"),e.push("</AdminAccessProtocolList>");var f=p.loadXML(e.join(""));b.success&&b.success(f)}},error:function(){b.error&&b.error()}})},error:function(){b.error&&b.error()}})},error:function(){var d=[];d.push("<AdminAccessProtocolList>"),o.getStreamChannels(a,{async:!1,success:function(e){if(c.$XML(e).find("rtspPortNo",!0).length>0){var f=parseInt(c.$XML(e).find("rtspPortNo").eq(0).text(),10);d.push("<AdminAccessProtocol>"),d.push("<id>4</id>"),d.push("<enabled>true</enabled>"),d.push("<protocol>RTSP</protocol>"),d.push("<portNo>"+f+"</portNo>"),d.push("</AdminAccessProtocol>"),d.push("</AdminAccessProtocolList>");var g=p.loadXML(d.join(""));b.success&&b.success(g)}else o.getStreamDynChannels(a,{async:!1,success:function(a){if(c.$XML(a).find("rtspPortNo",!0).length>0){var e=parseInt(c.$XML(a).find("rtspPortNo").eq(0).text(),10);d.push("<AdminAccessProtocol>"),d.push("<id>4</id>"),d.push("<enabled>true</enabled>"),d.push("<protocol>RTSP</protocol>"),d.push("<portNo>"+e+"</portNo>"),d.push("</AdminAccessProtocol>"),d.push("</AdminAccessProtocolList>");var f=p.loadXML(d.join(""));b.success&&b.success(f)}},error:function(){b.error&&b.error()}})},error:function(){b.error&&b.error()}})}}),e.setRequestParam(f),e.submitRequest()},L.prototype.getStreamChannels=function(a,b){if(0!=a.iAnalogChannelNum)var c=t(this.CGI.getStreamChannels.analog,a.szHttpProtocol,a.szIP,a.iCGIPort);else var c=t(this.CGI.getStreamChannels.digital,a.szHttpProtocol,a.szIP,a.iCGIPort);var d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.getStreamDynChannels=function(a,b){var c=t(this.CGI.getStreamDynChannels,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"GET",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.startRealPlay=function(a,b){var c=100*b.iChannelID+b.iStreamType,d="";d=b.bZeroChannel?t(b.cgi.zeroChannels,b.urlProtocol,a.szIP,b.iPort,c):t(b.cgi.channels,b.urlProtocol,a.szIP,b.iPort,c);var e=i.HWP_Play(d,a.szAuth,b.iWndIndex,"","");if(0==e){var f=new I;f.iIndex=b.iWndIndex,f.szIP=a.szIP,f.iChannelID=b.iChannelID,f.iPlayStatus=1,l.push(f)}return e},L.prototype.startVoiceTalk=function(a,b){var c=t(this.CGI.startVoiceTalk.open,a.szHttpProtocol,a.szIP,a.iCGIPort,b),d=t(this.CGI.startVoiceTalk.close,a.szHttpProtocol,a.szIP,a.iCGIPort,b),e=t(this.CGI.startVoiceTalk.audioData,a.szHttpProtocol,a.szIP,a.iCGIPort,b);return i.HWP_StartVoiceTalk(c,d,e,a.szAuth,a.iAudioType)},L.prototype.ptzAutoControl=function(a,b,c,d){var e=c.iChannelID,f="",g="";if(d.iPTZSpeed=d.iPTZSpeed<7?15*d.iPTZSpeed:100,b&&(d.iPTZSpeed=0),"IPDome"!=a.szDeviceType)f=t(this.CGI.ptzAutoControl,a.szHttpProtocol,a.szIP,a.iCGIPort,e),g="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+d.iPTZSpeed+"</pan><tilt>0</tilt></PTZData>";else{var h=99;b&&(h=96),f=t(this.CGI.goPreset,a.szHttpProtocol,a.szIP,a.iCGIPort,e,h)}var i=new J,j={type:"PUT",url:f,async:!1,auth:a.szAuth,data:g,success:null,error:null},k=this;p.extend(j,d),p.extend(j,{success:function(a){c.bPTZAuto=!c.bPTZAuto,d.success&&d.success(a)},error:function(b,e){if("IPDome"!=a.szDeviceType){f=t(k.CGI.ptzControl,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID);var h=new J,i={type:"PUT",url:f,async:!1,auth:a.szAuth,data:g,success:null,error:null};p.extend(i,d),h.setRequestParam(i),h.submitRequest()}else d.error&&d.error(b,e)}}),i.setRequestParam(j),i.submitRequest()},L.prototype.ptzControl=function(a,b,c,d){var e=(c.iChannelID,"");c.bPTZAuto&&this.ptzAutoControl(a,!0,c,{iPTZSpeed:0}),d.iPTZSpeed=b?0:d.iPTZSpeed<7?15*d.iPTZSpeed:100;var f=[{},{pan:0,tilt:d.iPTZSpeed},{pan:0,tilt:-d.iPTZSpeed},{pan:-d.iPTZSpeed,tilt:0},{pan:d.iPTZSpeed,tilt:0},{pan:-d.iPTZSpeed,tilt:d.iPTZSpeed},{pan:-d.iPTZSpeed,tilt:-d.iPTZSpeed},{pan:d.iPTZSpeed,tilt:d.iPTZSpeed},{pan:d.iPTZSpeed,tilt:-d.iPTZSpeed},{},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed},{speed:d.iPTZSpeed},{speed:-d.iPTZSpeed}],g="",h={};switch(d.iPTZIndex){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:h=this.CGI.ptzControl,g="<?xml version='1.0' encoding='UTF-8'?><PTZData><pan>"+f[d.iPTZIndex].pan+"</pan><tilt>"+f[d.iPTZIndex].tilt+"</tilt></PTZData>";break;case 10:case 11:h=this.CGI.ptzControl,g="<?xml version='1.0' encoding='UTF-8'?><PTZData><zoom>"+f[d.iPTZIndex].speed+"</zoom></PTZData>";break;case 12:case 13:h=this.CGI.ptzFocus,g="<?xml version='1.0' encoding='UTF-8'?><FocusData><focus>"+f[d.iPTZIndex].speed+"</focus></FocusData>";break;case 14:case 15:h=this.CGI.ptzIris,g="<?xml version='1.0' encoding='UTF-8'?><IrisData><iris>"+f[d.iPTZIndex].speed+"</iris></IrisData>";break;default:return void(u(d.error)&&d.error())}e=t(h,a.szHttpProtocol,a.szIP,a.iCGIPort,c.iChannelID);var i=new J,j={type:"PUT",url:e,async:!1,auth:a.szAuth,data:g,success:null,error:null};p.extend(j,d),p.extend(j,{success:function(a){d.success&&d.success(a)},error:function(a,b){d.error&&d.error(a,b)}}),i.setRequestParam(j),i.submitRequest()},L.prototype.setPreset=function(a,b,c){var d=(b.iChannelID,""),e="";d=t(this.CGI.setPreset,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID),e="<?xml version='1.0' encoding='UTF-8'?>",e+="<PTZPreset>",e+="<id>"+c.iPresetID+"</id>","IPDome"!=a.szDeviceType&&(e+="<presetName>Preset"+c.iPresetID+"</presetName>"),e+="</PTZPreset>";var f=new J,g={type:"PUT",url:d,auth:a.szAuth,data:e,success:null,error:null};p.extend(g,c),p.extend(g,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),f.setRequestParam(g),f.submitRequest()},L.prototype.goPreset=function(a,b,c){var d=(b.iChannelID,"");d=t(this.CGI.goPreset,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID,c.iPresetID);var e=new J,f={type:"PUT",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,c),p.extend(f,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),e.setRequestParam(f),e.submitRequest()},L.prototype.recordSearch=function(a,d){var e="",f="",g=d.iChannelID,h=d.szStartTime.replace(" ","T")+"Z",i=d.szEndTime.replace(" ","T")+"Z";e=t(this.CGI.recordSearch,a.szHttpProtocol,a.szIP,a.iCGIPort),f="<?xml version='1.0' encoding='UTF-8'?><CMSearchDescription><searchID>"+new b+"</searchID><trackList><trackID>"+(100*g+1)+"</trackID></trackList><timeSpanList><timeSpan><startTime>"+h+"</startTime><endTime>"+i+"</endTime></timeSpan></timeSpanList><maxResults>40</maxResults><searchResultPostion>"+d.iSearchPos+"</searchResultPostion><metadataList><metadataDescriptor>//metadata.psia.org/VideoMotion</metadataDescriptor></metadataList></CMSearchDescription>";var j=new J,k={type:"POST",url:e,auth:a.szAuth,data:f,success:null,error:null};p.extend(k,d),p.extend(k,{success:function(a){var b=[];b.push("<CMSearchResult>"),b.push("<responseStatus>"+c.$XML(a).find("responseStatus").eq(0).text()+"</responseStatus>"),b.push("<responseStatusStrg>"+c.$XML(a).find("responseStatusStrg").eq(0).text()+"</responseStatusStrg>"),b.push("<numOfMatches>"+c.$XML(a).find("numOfMatches").eq(0).text()+"</numOfMatches>"),b.push("<matchList>");for(var e=c.$XML(a).find("searchMatchItem",!0),f=0,g=e.length;f<g;f++){var h=e[f];b.push("<searchMatchItem>"),b.push("<trackID>"+c.$XML(h).find("trackID").eq(0).text()+"</trackID>"),b.push("<startTime>"+c.$XML(h).find("startTime").eq(0).text()+"</startTime>"),b.push("<endTime>"+c.$XML(h).find("endTime").eq(0).text()+"</endTime>"),b.push("<playbackURI>"+p.escape(c.$XML(h).find("playbackURI").eq(0).text())+"</playbackURI>"),b.push("<metadataDescriptor>"+c.$XML(h).find("metadataDescriptor").eq(0).text().split("/")[1]+"</metadataDescriptor>"),b.push("</searchMatchItem>")}b.push("</matchList>"),b.push("</CMSearchResult>"),a=p.loadXML(b.join("")),d.success&&d.success(a)},error:function(a,b){d.error&&d.error(a,b)}}),j.setRequestParam(k),j.submitRequest()},L.prototype.startPlayback=function(a,b){var c=b.iWndIndex,d=b.szStartTime,e=b.szEndTime,f=t(b.cgi,b.urlProtocol,a.szIP,b.iPort,b.iChannelID,d,e),g=i.HWP_Play(f,a.szAuth,c,d,e);if(0==g){var h=new I;h.iIndex=c,h.szIP=a.szIP,h.iChannelID=b.iChannelID,h.iPlayStatus=2,l.push(h)}return g},L.prototype.reversePlayback=function(a,b){var c=b.iWndIndex,d=b.szStartTime,e=b.szEndTime,f=t(b.cgi,b.urlProtocol,a.szIP,b.iPort,b.iChannelID,d,e),g=i.HWP_ReversePlay(f,a.szAuth,c,d,e);if(0==g){var h=new I;h.iIndex=c,h.szIP=a.szIP,h.iChannelID=b.iChannelID,h.iPlayStatus=5,l.push(h)}return g},L.prototype.startDownloadRecord=function(a,b){var c=t(this.CGI.startDownloadRecord,a.szHttpProtocol,a.szIP,a.iCGIPort),d="<?xml version='1.0' encoding='UTF-8'?><downloadRequest><playbackURI> "+p.escape(b.szPlaybackURI)+"</playbackURI></downloadRequest>";return i.HWP_StartDownload(c,a.szAuth,b.szFileName,d)},L.prototype.exportDeviceConfig=function(a){var b=t(this.CGI.deviceConfig,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_ExportDeviceConfig(b,a.szAuth,"",0)},L.prototype.importDeviceConfig=function(a,b){var c=t(this.CGI.deviceConfig,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_ImportDeviceConfig(c,a.szAuth,b.szFileName,0)},L.prototype.restart=function(a,b){var c=t(this.CGI.restart,a.szHttpProtocol,a.szIP,a.iCGIPort),d=new J,e={type:"PUT",url:c,auth:a.szAuth,success:null,error:null};p.extend(e,b),p.extend(e,{success:function(a){b.success&&b.success(a)},error:function(a,c){b.error&&b.error(a,c)}}),d.setRequestParam(e),d.submitRequest()},L.prototype.restore=function(a,b,c){var d=t(this.CGI.restore,a.szHttpProtocol,a.szIP,a.iCGIPort,b),e=new J,f={type:"PUT",url:d,auth:a.szAuth,success:null,error:null};p.extend(f,c),p.extend(f,{success:function(a){c.success&&c.success(a)},error:function(a,b){c.error&&c.error(a,b)}}),e.setRequestParam(f),e.submitRequest()},L.prototype.startUpgrade=function(a,b){var c=t(this.CGI.startUpgrade.upgrade,a.szHttpProtocol,a.szIP,a.iCGIPort),d=t(this.CGI.startUpgrade.status,a.szHttpProtocol,a.szIP,a.iCGIPort);return i.HWP_StartUpgrade(c,d,a.szAuth,b.szFileName)},L.prototype.set3DZoom=function(a,b,c,d){var e=t(this.CGI.set3DZoom,a.szHttpProtocol,a.szIP,a.iCGIPort,b.iChannelID),f=new J,g={type:"PUT",url:e,data:c,auth:a.szAuth,success:null,error:null};p.extend(g,d),p.extend(g,{success:function(a){d.success&&d.success(a)},error:function(a,b){d.error&&d.error(a,b)}}),f.setRequestParam(g),f.submitRequest()};var M=function(){};M.prototype._alert=function(a){h.bDebugMode&&console.log(a)},function(b){var c=function(a){this.elems=[],this.length=0,this.length=this.elems.push(a)};c.prototype.find=function(a,b){var c=this.elems[this.length-1].getElementsByTagName(a);return this.length=this.elems.push(c),b?c:this},c.prototype.eq=function(a,b){var c=this.elems[this.length-1].length,d=null;return c>0&&a<c&&(d=this.elems[this.length-1][a]),this.length=this.elems.push(d),b?d:this},c.prototype.text=function(b){return this.elems[this.length-1]?b?void(a.DOMParser?this.elems[this.length-1].textContent=b:this.elems[this.length-1].text=b):a.DOMParser?this.elems[this.length-1].textContent:this.elems[this.length-1].text:""},c.prototype.attr=function(a){if(this.elems[this.length-1]){var b=this.elems[this.length-1].attributes.getNamedItem(a);return b?b.value:""}},b.$XML=function(a){return new c(a)}}(this);var N=function(){};N.prototype.extend=function(){for(var a,b=arguments[0]||{},c=1,d=arguments.length;c<d;c++)if(null!=(a=arguments[c]))for(var e in a){var f=(b[e],a[e]);b!==f&&("object"==typeof f?b[e]=this.extend({},f):void 0!==f&&(b[e]=f))}return b},N.prototype.browser=function(){var a=/(chrome)[ \/]([\w.]+)/,b=/(safari)[ \/]([\w.]+)/,c=/(opera)(?:.*version)?[ \/]([\w.]+)/,d=/(msie) ([\w.]+)/,e=/(trident.*rv:)([\w.]+)/,f=/(mozilla)(?:.*? rv:([\w.]+))?/,g=navigator.userAgent.toLowerCase(),h=a.exec(g)||b.exec(g)||c.exec(g)||d.exec(g)||e.exec(g)||g.indexOf("compatible")<0&&f.exec(g)||["unknow","0"];h.length>0&&h[1].indexOf("trident")>-1&&(h[1]="msie");var i={};return i[h[1]]=!0,i.version=h[2],i},N.prototype.loadXML=function(b){if(null==b||""==b)return null;var c=null;if(a.DOMParser){c=(new DOMParser).parseFromString(b,"text/xml")}else c=new ActiveXObject("Microsoft.XMLDOM"),c.async=!1,c.loadXML(b);return c},N.prototype.toXMLStr=function(a){var b="";try{var c=new XMLSerializer;b=c.serializeToString(a)}catch(c){try{b=a.xml}catch(a){return""}}return-1==b.indexOf("<?xml")&&(b="<?xml version='1.0' encoding='utf-8'?>"+b),b},N.prototype.escape=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},N.prototype.dateFormat=function(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},N.prototype.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=N.prototype.Base64._utf8_encode(a);j<a.length;)b=a.charCodeAt(j++),c=a.charCodeAt(j++),d=a.charCodeAt(j++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,h=63&d,isNaN(c)?g=h=64:isNaN(d)&&(h=64),i=i+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h);return i},decode:function(a){var b,c,d,e,f,g,h,i="",j=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j<a.length;)e=this._keyStr.indexOf(a.charAt(j++)),f=this._keyStr.indexOf(a.charAt(j++)),g=this._keyStr.indexOf(a.charAt(j++)),h=this._keyStr.indexOf(a.charAt(j++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|h,i+=String.fromCharCode(b),64!=g&&(i+=String.fromCharCode(c)),64!=h&&(i+=String.fromCharCode(d));return i=N.prototype.Base64._utf8_decode(i)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}},b.prototype.valueOf=function(){return this.id},b.prototype.toString=function(){return this.id},b.prototype.createUUID=function(){var a=new Date(1582,10,15,0,0,0,0),c=new Date,d=c.getTime()-a.getTime(),e="-";return b.getIntegerBits(d,0,31)+e+b.getIntegerBits(d,32,47)+e+(b.getIntegerBits(d,48,59)+"1")+e+b.getIntegerBits(b.rand(4095),0,7)+b.getIntegerBits(b.rand(4095),0,7)+e+(b.getIntegerBits(b.rand(8191),0,7)+b.getIntegerBits(b.rand(8191),8,15)+b.getIntegerBits(b.rand(8191),0,7)+b.getIntegerBits(b.rand(8191),8,15)+b.getIntegerBits(b.rand(8191),0,15))},b.getIntegerBits=function(a,c,d){var e=b.returnBase(a,16),f=new Array,g="",h=0;for(h=0;h<e.length;h++)f.push(e.substring(h,h+1));for(h=Math.floor(c/4);h<=Math.floor(d/4);h++)f[h]&&""!=f[h]?g+=f[h]:g+="0";return g},b.returnBase=function(a,b){var c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(a<b)var d=c[a];else{var e=""+Math.floor(a/b),f=a-e*b;if(e>=b)var d=this.returnBase(e,b)+c[f];else var d=c[e]+c[f]}return d},b.rand=function(a){return Math.floor(Math.random()*a)},n=new K,o=new L,m=new M,p=new N;var O=p.dateFormat(new Date,"yyyyMMddhhmmss");if(f="webVideoCtrl"+O,g="webVideoCtrl"+O,"object"!=typeof a.attachEvent&&p.browser().msie){var P="<script for="+f+" event='GetSelectWndInfo(SelectWndInfo)'>GetSelectWndInfo(SelectWndInfo);<\/script>";P+="<script for="+f+" event='ZoomInfoCallback(szZoomInfo)'>ZoomInfoCallback(szZoomInfo);<\/script>",P+="<script for="+f+"  event='GetHttpInfo(lID, lpInfo, lReverse)'>GetHttpInfo(lID, lpInfo, lReverse);<\/script>",P+="<script for="+f+"  event='PluginEventHandler(iEventType, iParam1, iParam2)'>PluginEventHandler(iEventType, iParam1, iParam2);<\/script>",document.write(P)}return this}(),c=a.WebVideoCtrl=b;c.version="1.0.9"}}(this);