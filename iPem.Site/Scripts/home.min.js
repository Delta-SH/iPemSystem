(function(){var k=null,d=null,f=null,b=null,i=null,q=null,o=null,r={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["\u4e00\u7ea7\u544a\u8b66","\u4e8c\u7ea7\u544a\u8b66","\u4e09\u7ea7\u544a\u8b66","\u56db\u7ea7\u544a\u8b66"],align:"left"},grid:{top:25,left:5,right:5,bottom:5,containLabel:true},xAxis:[{type:"category",data:[],splitLine:{show:false}}],yAxis:[{type:"value"}],series:[{name:"\u4e00\u7ea7\u544a\u8b66",type:"bar",itemStyle:{normal:{color:"#f04b51"}},stack:"alarm",data:[]},{name:"\u4e8c\u7ea7\u544a\u8b66",type:"bar",itemStyle:{normal:{color:"#efa91f"}},stack:"alarm",data:[]},{name:"\u4e09\u7ea7\u544a\u8b66",type:"bar",itemStyle:{normal:{color:"#f5d313"}},stack:"alarm",data:[]},{name:"\u56db\u7ea7\u544a\u8b66",type:"bar",itemStyle:{normal:{color:"#0892cd"}},stack:"alarm",data:[]}]},p={tooltip:{trigger:"axis",formatter:"{b}<br/>{c}%"},grid:{top:10,left:0,right:15,bottom:0,containLabel:true},xAxis:{type:"category",boundaryGap:false,splitLine:{show:false},data:[]},yAxis:{type:"value",max:100,min:0},series:[{name:"CPU",type:"line",smooth:true,symbol:"none",sampling:"average",itemStyle:{normal:{color:"#0892cd"}},areaStyle:{normal:{}},data:[]}]},m={tooltip:{trigger:"axis",formatter:"{b}<br/>{c}%"},grid:{top:10,left:0,right:15,bottom:0,containLabel:true},xAxis:{type:"category",boundaryGap:false,splitLine:{show:false},data:[]},yAxis:{type:"value",max:100,min:0},series:[{name:"Memory",type:"line",smooth:true,symbol:"none",sampling:"average",itemStyle:{normal:{color:"#b198dc"}},areaStyle:{normal:{}},data:[]}]},j={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},series:[{name:"\u80fd\u8017\u5206\u7c7b\u5360\u6bd4",type:"pie",radius:["40%","70%"],avoidLabelOverlap:false,label:{normal:{show:false,position:"center"},emphasis:{show:true,textStyle:{fontSize:"20",fontWeight:"bold"}}},labelLine:{normal:{show:false}},data:[{value:895,name:"\u7a7a\u8c03"},{value:221,name:"\u7167\u660e"},{value:152,name:"\u529e\u516c"},{value:335,name:"\u5176\u4ed6"}]}]},h={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["\u7a7a\u8c03","\u7167\u660e","\u529e\u516c","\u5176\u4ed6"],align:"left"},grid:{top:25,left:5,right:5,bottom:5,containLabel:true},xAxis:[{type:"category",data:["\u5317\u4eac\u5e02","\u4e0a\u6d77\u5e02","\u6d59\u6c5f\u7701","\u6c5f\u82cf\u7701","\u6cb3\u5317\u7701","\u5e7f\u4e1c\u7701","\u5409\u6797\u7701"],splitLine:{show:false}}],yAxis:[{type:"value"}],series:[{name:"\u7a7a\u8c03",type:"bar",data:[120,132,101,134,90,230,210]},{name:"\u7167\u660e",type:"bar",data:[220,182,191,234,290,330,310]},{name:"\u529e\u516c",type:"bar",data:[150,232,201,154,190,330,410]},{name:"\u5176\u4ed6",type:"bar",data:[220,182,191,234,290,330,310]}]},g={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{x:"center",y:"bottom",data:["\u6b63\u5e38","\u65ad\u7ad9"]},series:[{name:"\u7ad9\u70b9\u65ad\u7ad9\u7387",type:"pie",radius:["40%","70%"],avoidLabelOverlap:false,label:{normal:{show:false,position:"center"},emphasis:{show:true,textStyle:{fontSize:"20",fontWeight:"bold"}}},labelLine:{normal:{show:false}},data:[{value:0,name:"\u6b63\u5e38",itemStyle:{normal:{color:"#48ac2e"}}},{value:0,name:"\u65ad\u7ad9",itemStyle:{normal:{color:"#c12e34"}}}]}]},e={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{x:"center",y:"bottom",data:["\u6b63\u5e38","\u79bb\u7ebf"]},series:[{name:"Fsu\u79bb\u7ebf\u7387",type:"pie",radius:["40%","70%"],avoidLabelOverlap:false,label:{normal:{show:false,position:"center"},emphasis:{show:true,textStyle:{fontSize:"20",fontWeight:"bold"}}},labelLine:{normal:{show:false}},data:[{value:0,name:"\u6b63\u5e38",itemStyle:{normal:{color:"#48ac2e"}}},{value:0,name:"\u79bb\u7ebf",itemStyle:{normal:{color:"#c12e34"}}}]}]};Ext.define("UnconnectedModel",{extend:"Ext.data.Model",fields:[{name:"index",type:"int"},{name:"area",type:"string"},{name:"station",type:"string"},{name:"time",type:"string"},{name:"interval",type:"string"}],idProperty:"index"});Ext.define("OffModel",{extend:"Ext.data.Model",fields:[{name:"index",type:"int"},{name:"area",type:"string"},{name:"station",type:"string"},{name:"room",type:"string"},{name:"name",type:"string"},{name:"time",type:"string"},{name:"interval",type:"string"}],idProperty:"index"});var n=Ext.create("Ext.data.Store",{autoLoad:false,pageSize:20,model:"UnconnectedModel",proxy:{type:"ajax",url:"/Home/RequestHomeUnconnected",reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"},simpleSortMode:true},listeners:{load:function(t,s,v){if(v){var u=t.proxy.reader.jsonData;if(!Ext.isEmpty(u)&&!Ext.isEmpty(u.chart)&&Ext.isArray(u.chart)&&u.chart.length==2&&q!==null){if(!Ext.isEmpty(u.chart[0])){g.series[0].data[0].value=u.chart[0].value}if(!Ext.isEmpty(u.chart[1])){g.series[0].data[1].value=u.chart[1].value}q.setOption(g)}$$iPems.Tasks.homeTasks.unconnectedTask.fireOnStart=false;$$iPems.Tasks.homeTasks.unconnectedTask.restart()}}}});var c=Ext.create("Ext.data.Store",{autoLoad:false,pageSize:20,model:"OffModel",proxy:{type:"ajax",url:"/Home/RequestHomeOff",reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"},simpleSortMode:true},listeners:{load:function(t,s,v){if(v){var u=t.proxy.reader.jsonData;if(!Ext.isEmpty(u)&&!Ext.isEmpty(u.chart)&&Ext.isArray(u.chart)&&u.chart.length==2&&o!==null){if(!Ext.isEmpty(u.chart[0])){e.series[0].data[0].value=u.chart[0].value}if(!Ext.isEmpty(u.chart[1])){e.series[0].data[1].value=u.chart[1].value}o.setOption(e)}$$iPems.Tasks.homeTasks.offTask.fireOnStart=false;$$iPems.Tasks.homeTasks.offTask.restart()}}}});var a=$$iPems.clonePagingToolbar(n);var l=$$iPems.clonePagingToolbar(c);Ext.onReady(function(){var t=Ext.create("Ext.panel.Panel",{region:"center",header:false,border:false,overflowY:"auto",defaults:{margin:"0 22 0 0"},layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",flex:1,contentEl:"alm-0-container"},{xtype:"component",width:10},{xtype:"container",flex:1,contentEl:"alm-1-container"},{xtype:"component",width:10},{xtype:"container",flex:1,contentEl:"alm-2-container"},{xtype:"component",width:10},{xtype:"container",flex:1,contentEl:"alm-3-container"},{xtype:"component",width:10},{xtype:"container",flex:1,contentEl:"alm-4-container"}]},{xtype:"component",height:10},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",glyph:61489,title:"\u533a\u57df\u544a\u8b66\u5206\u5e03\u56fe",collapsible:true,collapseFirst:false,flex:3,contentEl:"alm-chart"},{xtype:"component",width:5},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",glyph:61496,title:"CPU\u5229\u7528\u7387",collapsible:true,collapseFirst:false,flex:1,contentEl:"cpu-chart"},{xtype:"component",height:5},{xtype:"panel",glyph:61496,title:"\u5185\u5b58\u5229\u7528\u7387",collapsible:true,collapseFirst:false,flex:1,contentEl:"memory-chart"}]}]},{xtype:"component",height:10},{xtype:"panel",glyph:61489,title:"\u533a\u57df\u80fd\u8017\u5206\u5e03\u56fe",collapsible:true,collapseFirst:false,layout:{type:"hbox",align:"stretch"},cls:"energyview",items:[{xtype:"container",flex:3,contentEl:"energy-bar"},{xtype:"component",height:5},{xtype:"container",flex:1,contentEl:"energy-pie"}]},{xtype:"component",height:10},{xtype:"panel",glyph:61488,title:"\u7ad9\u70b9\u65ad\u7ad9\u5217\u8868",collapsible:true,collapseFirst:false,layout:{type:"hbox",align:"stretch"},tools:[{type:"print",tooltip:"\u6570\u636e\u5bfc\u51fa",handler:function(w,v,u){$$iPems.download({url:"/Home/DownloadHomeUnconnected",params:n.proxy.extraParams})}}],cls:"unconnectedview",items:[{xtype:"container",flex:1,contentEl:"unconnected-pie"},{xtype:"component",height:5},{xtype:"grid",flex:3,store:n,border:false,style:{"border-left":"1px solid #c0c0c0"},viewConfig:{loadMask:false,trackOver:true,stripeRows:true,emptyText:'<h1 style="margin:20px">\u6ca1\u6709\u6570\u636e\u8bb0\u5f55</h1>',preserveScrollOnRefresh:true},columns:[{text:"\u5e8f\u53f7",dataIndex:"index",width:60,align:"left",sortable:true},{text:"\u6240\u5c5e\u533a\u57df",dataIndex:"area",align:"left",flex:1,sortable:true},{text:"\u7ad9\u70b9\u540d\u79f0",dataIndex:"station",align:"left",width:120,sortable:true},{text:"\u65ad\u7ad9\u65f6\u95f4",dataIndex:"time",width:150,align:"left",sortable:true},{text:"\u65ad\u7ad9\u65f6\u957f",dataIndex:"interval",width:120,align:"left",sortable:true}],bbar:a}]},{xtype:"component",height:10},{xtype:"panel",glyph:61488,title:"Fsu\u79bb\u7ebf\u5217\u8868",collapsible:true,collapseFirst:false,layout:{type:"hbox",align:"stretch"},tools:[{type:"print",tooltip:"\u6570\u636e\u5bfc\u51fa",handler:function(w,v,u){$$iPems.download({url:"/Home/DownloadHomeOff",params:c.proxy.extraParams})}}],cls:"offlineview",items:[{xtype:"container",flex:1,contentEl:"offline-pie"},{xtype:"component",height:5},{xtype:"grid",flex:3,store:c,border:false,style:{"border-left":"1px solid #c0c0c0"},viewConfig:{loadMask:false,trackOver:true,stripeRows:true,emptyText:'<h1 style="margin:20px">\u6ca1\u6709\u6570\u636e\u8bb0\u5f55</h1>',preserveScrollOnRefresh:true},columns:[{text:"\u5e8f\u53f7",dataIndex:"index",width:60,align:"left",sortable:true},{text:"\u6240\u5c5e\u533a\u57df",dataIndex:"area",align:"left",flex:1,sortable:true},{text:"\u6240\u5c5e\u7ad9\u70b9",dataIndex:"station",align:"left",width:120,sortable:true},{text:"\u6240\u5c5e\u673a\u623f",dataIndex:"room",align:"left",width:120,sortable:true},{text:"Fsu\u540d\u79f0",dataIndex:"name",align:"left",width:120,sortable:true},{text:"\u79bb\u7ebf\u65f6\u95f4",dataIndex:"time",width:150,align:"left",sortable:true},{text:"\u79bb\u7ebf\u65f6\u957f",dataIndex:"interval",width:120,align:"left",sortable:true}],bbar:l}]}]});var s=Ext.getCmp("center-content-panel-fw");if(!Ext.isEmpty(s)){s.add(t)}});Ext.onReady(function(){k=echarts.init(document.getElementById("alm-chart"),"shine");d=echarts.init(document.getElementById("cpu-chart"),"shine");f=echarts.init(document.getElementById("memory-chart"),"shine");b=echarts.init(document.getElementById("energy-bar"),"shine");i=echarts.init(document.getElementById("energy-pie"),"shine");q=echarts.init(document.getElementById("unconnected-pie"),"shine");o=echarts.init(document.getElementById("offline-pie"),"shine");k.setOption(r);d.setOption(p);f.setOption(m);b.setOption(h);i.setOption(j);q.setOption(g);o.setOption(e);$$iPems.Tasks.homeTasks.almTask.run=function(){Ext.Ajax.request({url:"/Home/RequestHomeAlm",success:function(s,t){var w=Ext.decode(s.responseText,true);if(w.success){if(!Ext.isEmpty(w.data)){var u=w.data,v=u.alarms;$$iPems.animateNumber("alm-0-count",u.total);$$iPems.animateNumber("alm-1-count",u.total1);$$iPems.animateNumber("alm-2-count",u.total2);$$iPems.animateNumber("alm-3-count",u.total3);$$iPems.animateNumber("alm-4-count",u.total4);if(!Ext.isEmpty(v)&&Ext.isArray(v)){r.xAxis[0].data=[];r.series[0].data=[];r.series[1].data=[];r.series[2].data=[];r.series[3].data=[];Ext.Array.each(v,function(y,x){r.xAxis[0].data.push(y.name);r.series[0].data.push(y.level1);r.series[1].data.push(y.level2);r.series[2].data.push(y.level3);r.series[3].data.push(y.level4)});k.setOption(r,true)}}$$iPems.Tasks.homeTasks.almTask.fireOnStart=false;$$iPems.Tasks.homeTasks.almTask.restart()}else{Ext.Msg.show({title:"\u7cfb\u7edf\u9519\u8bef",msg:w.message,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}})};$$iPems.Tasks.homeTasks.almTask.start();$$iPems.Tasks.homeTasks.svrTask.run=function(){Ext.Ajax.request({url:"/Home/RequestHomeSvr",success:function(s,t){var v=Ext.decode(s.responseText,true);if(v.success){if(!Ext.isEmpty(v.data)){var u=v.data;if(p.xAxis.data.length>60){p.xAxis.data.shift()}if(p.series[0].data.length>60){p.series[0].data.shift()}if(m.xAxis.data.length>60){m.xAxis.data.shift()}if(m.series[0].data.length>60){m.series[0].data.shift()}p.xAxis.data.push(u.time);p.series[0].data.push(u.cpu);m.xAxis.data.push(u.time);m.series[0].data.push(u.memory);d.setOption(p);f.setOption(m)}$$iPems.Tasks.homeTasks.svrTask.fireOnStart=false;$$iPems.Tasks.homeTasks.svrTask.restart()}else{Ext.Msg.show({title:"\u7cfb\u7edf\u9519\u8bef",msg:v.message,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}})};$$iPems.Tasks.homeTasks.svrTask.start();$$iPems.Tasks.homeTasks.offTask.run=function(){l.doRefresh()};$$iPems.Tasks.homeTasks.offTask.start();$$iPems.Tasks.homeTasks.unconnectedTask.run=function(){a.doRefresh()};$$iPems.Tasks.homeTasks.unconnectedTask.start()})})();
