(function(){var h=['<audio id="media-player" controls="controls" style="width:100%;">','<source src="" type="audio/wav">','<div class="alert alert-danger" role="alert">','<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>','<span class="sr-only">Error:</span>',"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301HTML5 Audio\uff0c\u8bf7\u5c06\u6d4f\u89c8\u5668\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\u3002","</div>","</audio>"];var c=['<object id="media-player" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" type="application/x-oleobject" style="width:100%; height:65px;">','<param name="URL" value="" />','<param name="volume" value="100" />',"</object>"];var g=['<div class="alert alert-danger" role="alert">','<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>','<span class="sr-only">Error:</span>',"\u7cfb\u7edf\u672a\u5b89\u88c5Windows Media Player\u6216\u5b89\u88c5\u7248\u672c\u8f83\u4f4e\uff0c\u8bf7\u5b89\u88c5\u6700\u65b0\u7248\u672c\u7684Windows Media Player\u3002","</div>"];$.ieVersion=(function(){var k=window.navigator.userAgent;var j=k.indexOf("MSIE ");var i=k.indexOf("Trident/");if(j>0){return parseInt(k.substring(j+5,k.indexOf(".",j)),10)}if(i>0){var l=k.indexOf("rv:");return parseInt(k.substring(l+3,k.indexOf(".",l)),10)}return -1}());$.isIE=$.ieVersion>-1;$.playing=false;$.initDelay=20;$.startDelay=5;var b=function(){var i,j;try{if(window.ActiveXObject||"ActiveXObject" in window){i=new ActiveXObject("WMPlayer.OCX.7")}else{if(window.GeckoActiveXObject||"GeckoActiveXObject" in window){i=new GeckoActiveXObject("WMPlayer.OCX.7")}}}catch(k){}try{if(navigator.mimeTypes){j=navigator.mimeTypes["application/x-mplayer2"].enabledPlugin}}catch(k){}return(i||j)};var d=function(k){var i="/Home/Speaker?text="+encodeURIComponent(k);if($.player){var j=$.player[0];if(!$.isIE){j.src=i;j.play()}else{j.URL=i;j.controls.play()}}};var a=function(){if($.player){var i=$.player[0];if(!$.isIE){i[0].pause();i[0].currentTime=0}else{i[0].controls.stop()}}};var e=function(){if($.contents&&$.contents.length>0){return false}$.ajax({url:"/Home/GetSpeech",dataType:"json",cache:false,beforeSend:function(i){if($.initTask){window.clearInterval($.initTask)}},success:function(j,k,i){if(j.success){$.contents=j.data}}}).always(function(){$.initTask=window.setInterval(e,$.initDelay*1000)})};var f=function(){if($.playing){return false}if($.contents&&$.contents.length>0){$.playing=true;window.setTimeout(function(){d($.contents.shift())},1000)}};$(document).ready(function(){var i=$("#media-container");if(i){if($.isIE){i.html(b()?c.join(""):g.join(""))}else{i.html(h.join(""))}}$.player=$("#media-player");if($.player&&!$.isIE){$.player.on("ended",function(){$.playing=false})}e();window.setInterval(f,$.startDelay*1000)})})();
