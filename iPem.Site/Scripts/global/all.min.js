window.$$iPems.icons={Add:"/content/themes/icons/add.png",Cancel:"/content/themes/icons/cancel.png",Clear:"/content/themes/icons/clear.png",Cog:"/content/themes/icons/cog.png",Delete:"/content/themes/icons/delete.png",Department:"/content/themes/icons/department.png",Detail:"/content/themes/icons/detail.png",Dingwei:"/content/themes/icons/dingwei.png",Diqiu:"/content/themes/icons/diqiu.png",Edit:"/content/themes/icons/edit.png",Employee:"/content/themes/icons/employee.png",Error:"/content/themes/icons/error.png",Excel:"/content/themes/icons/excel.png",Exit:"/content/themes/icons/exit.png",Home:"/content/themes/icons/home.png",Jifang:"/content/themes/icons/jifang.png",Junheng:"/content/themes/icons/junheng.png",Juzhan:"/content/themes/icons/juzhan.png",Leaf:"/content/themes/icons/leaf.png",Loading:"/content/themes/icons/loading.gif",Locked:"/content/themes/icons/locked.gif",Menu:"/content/themes/icons/menu.png",Ok:"/content/themes/icons/ok.png",Password:"/content/themes/icons/password.png",Print:"/content/themes/icons/print.png",Read:"/content/themes/icons/read.png",Remove:"/content/themes/icons/remove.png",Save:"/content/themes/icons/save.png",Tick:"/content/themes/icons/tick.png",Unread:"/content/themes/icons/unread.png",User:"/content/themes/icons/user.png"};Ext.require(["*"]);Ext.setGlyphFontFamily("ipems-icon-font");Ext.Ajax.timeout=300000;Ext.override(Ext.data.Connection,{timeout:Ext.Ajax.timeout});Ext.override(Ext.data.JsonP,{timeout:Ext.Ajax.timeout});Ext.override(Ext.form.Basic,{timeout:Ext.Ajax.timeout/1000,afterAction:function(c,d){this.callParent(arguments);var a=c.preventWindow||false;if(a!==true&&!d){var b="";if(!Ext.isEmpty(c.result)&&!Ext.isEmpty(c.result.message)){b=c.result.message}$$iPems.ShowFailure(c.response,b)}},getValues:function(i,j,n,l){var m={},g=this.getFields().items,h,o=g.length,e=Ext.isArray,k,d,c,b,a;for(h=0;h<o;h++){k=g[h];if(!j||k.isDirty()){d=k[l?"getModelData":"getSubmitData"](n);if(Ext.isObject(d)){for(a in d){if(d.hasOwnProperty(a)){c=d[a];if(!n&&c===""){continue}if(n&&c===""){c=k.emptyText||""}if(m.hasOwnProperty(a)){b=m[a];if(!e(b)){b=m[a]=[b]}if(e(c)){m[a]=b.concat(c)}else{b.push(c)}}else{m[a]=c}}}}}}if(i){m=Ext.Object.toQueryString(m)}return m}});Ext.override(Ext.Ajax,{unauthorizedCode:400});Ext.Ajax.on("beforerequest",function(b,a){if(!Ext.isEmpty(a.mask)){a.mask.show()}});Ext.Ajax.on("requestcomplete",function(c,a,b){if(!Ext.isEmpty(b.mask)){b.mask.hide()}});Ext.Ajax.on("requestexception",function(d,b,c){if(!Ext.isEmpty(c.mask)){c.mask.hide()}if(b.status===Ext.Ajax.unauthorizedCode){var e=Ext.decode(b.responseText,true);if(!Ext.isEmpty(e)&&!Ext.isEmpty(e.LoginUrl)){window.location.href=e.LoginUrl;return false}}var a=c.preventWindow||false;if(a!==true){$$iPems.ShowFailure(b,b.responseText)}});Ext.direct.Manager.on("exception",function(a){if(!Ext.isEmpty(a)&&!Ext.isEmpty(a.message)){Ext.Msg.show({title:"\u7cfb\u7edf\u9519\u8bef",msg:a.message,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}});Ext.override(Ext.form.field.Date,{format:"Y-m-d"});Ext.override(Ext.chart.series.Line,{highlightItem:function(){var b=this,a=b.line;Ext.chart.series.Line.superclass.highlightItem.apply(this,arguments);if(a&&!b.highlighted&&b.highlightLine!==false){if(!("__strokeWidth" in a)){a.__strokeWidth=parseFloat(a.attr["stroke-width"])||0}if(a.__anim){a.__anim.paused=true}a.__anim=new Ext.fx.Anim({target:a,to:{"stroke-width":a.__strokeWidth+3}});b.highlighted=true}}});window.$$iPems.ShowFailure=function(b,e){var c=Ext.getBody().getViewSize(),d=(c.width<500)?c.width-50:500,a=(c.height<300)?c.height-50:300,f;if(Ext.isEmpty(e)){e=b.responseText}if(b.status===0&&Ext.isEmpty(b.statusText)&&Ext.isEmpty(e)){return false}f=new Ext.window.Window({modal:true,width:d,height:a,title:"\u7cfb\u7edf\u9519\u8bef",layout:"fit",maximizable:true,items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",height:42,layout:"absolute",defaultType:"label",items:[{xtype:"component",x:5,y:5,html:'<div class="x-message-box-error" style="width:32px;height:32px"></div>'},{x:42,y:5,html:"<b>Status Code: </b>"},{x:128,y:5,text:b.status},{x:42,y:23,html:"<b>Status Text: </b>"},{x:128,y:23,text:b.statusText}]},{flex:1,xtype:"htmleditor",value:e,readOnly:true,enableAlignments:false,enableColors:false,enableFont:false,enableFontSize:false,enableFormat:false,enableLinks:false,enableLists:false,enableSourceEdit:false}]}]});f.show()};Ext.override(Ext.panel.Header,{initComponent:function(){this.callParent(arguments);this.insert(0,this.iconCmp);this.insert(1,this.titleCmp)}});Ext.override(Ext.view.Table,{getRecord:function(a){a=this.getNode(a);if(a){return this.dataSource.data.get(a.getAttribute("data-recordId"))}},indexInStore:function(a){a=this.getNode(a,true);if(!a&&a!==0){return -1}return this.dataSource.indexOf(this.getRecord(a))}});window.$$iPems.Action={Add:0,Edit:1,Delete:2};window.$$iPems.Organization={Area:0,Station:1,Room:2,Device:3,Point:4};window.$$iPems.Point={DI:0,AI:1,DO:2,AO:3};window.$$iPems.PointStatus={Normal:0,Level1:1,Level2:2,Level3:3,Level4:4,Opevent:5,Invalid:6};window.$$iPems.GetPointStatusCls=function(a){switch(a){case $$iPems.PointStatus.Normal:return"point-status-normal";case $$iPems.PointStatus.Level1:return"point-status-level1";case $$iPems.PointStatus.Level2:return"point-status-level2";case $$iPems.PointStatus.Level3:return"point-status-level3";case $$iPems.PointStatus.Level4:return"point-status-level4";case $$iPems.PointStatus.Opevent:return"point-status-opevent";case $$iPems.PointStatus.Invalid:return"point-status-invalid";default:return""}};window.$$iPems.AlmLevel={Level1:1,Level2:2,Level3:3,Level4:4};window.$$iPems.GetAlmLevelCls=function(a){switch(a){case $$iPems.AlmLevel.Level1:return"alm-level1";case $$iPems.AlmLevel.Level2:return"alm-level2";case $$iPems.AlmLevel.Level3:return"alm-level3";case $$iPems.AlmLevel.Level4:return"alm-level4";default:return""}};window.$$iPems.SplitKeys=function(a){if(Ext.isEmpty(a)){return[]}return a.split($$iPems.Separator)};window.$$iPems.Delimiter=";";window.$$iPems.Separator="\u2506";window.$$iPems.download=function(b){b=b||{};var a=b.url,e=b.method||"POST",d=b.params||{};var c=Ext.create("Ext.form.Panel",{standardSubmit:true,url:a,method:e});c.submit({target:"_blank",params:d});Ext.defer(function(){c.close()},100)};window.$$iPems.datetimeParse=function(a,b){return Ext.Date.parse(a,b||"Y-m-d H:i:s",true)};window.$$iPems.dateParse=function(a,b){return Ext.Date.parse(a,b||"Y-m-d",true)};window.$$iPems.clonePagingToolbar=function(a){return Ext.create("Ext.PagingToolbar",{store:a,displayInfo:true,items:["-",{store:new Ext.data.Store({fields:[{name:"id",type:"int"},{name:"text",type:"string"},{name:"comment",type:"string"}],data:[{id:10,text:"10",comment:"10"},{id:20,text:"20",comment:"20"},{id:50,text:"50",comment:"50"},{id:100,text:"100",comment:"100"},{id:200,text:"200",comment:"200"},{id:500,text:"500",comment:"500"}]}),xtype:"combobox",fieldLabel:"\u663e\u793a\u6761\u6570",displayField:"text",valueField:"id",typeAhead:true,queryMode:"local",triggerAction:"all",emptyText:"\u6bcf\u9875\u663e\u793a\u7684\u6761\u6570",selectOnFocus:true,forceSelection:true,labelWidth:60,width:200,value:a.pageSize,listeners:{select:function(b){a.pageSize=parseInt(b.getValue());a.loadPage(1)}}}]})};window.$$iPems.selectNodePath=function(a,f,g){var b=a.getRootNode(),e="id",d="/",c=d+b.get(e)+d+f.join(d);a.selectPath(c,e,d,g||Ext.emptyFn)};window.$$iPems.animateNumber=function(h,b){if(Ext.isString(h)){h=Ext.get(h)}b=Math.round(b);var j=h.getHTML();var i=Ext.isEmpty(j)?0:parseInt(j);var g=Math.abs(b-i);var d=b>i;var e=25,f=Math.round(g/e),a=25;var c=setInterval(function(){if(d){if(f>1&&i+f<b){i+=f;h.setHTML(i)}else{if(i<b){i+=1;h.setHTML(i)}else{clearInterval(c)}}}else{if(f>1&&i-f>b){i-=f;h.setHTML(i)}else{if(i>b){i-=1;h.setHTML(i)}else{clearInterval(c)}}}},a)};window.$$iPems.Tasks={noticeTask:Ext.util.TaskManager.newTask({run:function(){Ext.Ajax.request({url:"/Home/GetNoticesCount",preventWindow:true,success:function(b,c){var e=Ext.decode(b.responseText,true);if(e.success){var d=e.data,a=Ext.get("noticeCount");if(!Ext.isEmpty(a)){a.setHTML(d>99?"99+":d);a.setDisplayed(d>0);$$iPems.Tasks.noticeTask.fireOnStart=false;$$iPems.Tasks.noticeTask.restart()}}}})},fireOnStart:true,interval:15000,repeat:1}),actAlmNoticeTask:Ext.util.TaskManager.newTask({run:function(){Ext.Ajax.request({url:"/Home/GetActAlmCount",preventWindow:true,success:function(b,c){var e=Ext.decode(b.responseText,true);if(e.success){var d=e.data,a=Ext.get("actAlmCount");if(!Ext.isEmpty(a)){a.setHTML(d>99?"99+":d);a.setDisplayed(d>0);$$iPems.Tasks.actAlmNoticeTask.fireOnStart=false;$$iPems.Tasks.actAlmNoticeTask.restart()}}}})},fireOnStart:true,interval:15000,repeat:1}),actAlmTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:15000,repeat:1}),actPointTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:15000,repeat:1}),homeTasks:{almTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:15000,repeat:1}),svrTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:5000,repeat:1}),unconnectedTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:15000,repeat:1}),offTask:Ext.util.TaskManager.newTask({run:Ext.emptyFn,fireOnStart:true,interval:15000,repeat:1})}};Ext.onReady(function(){Ext.tip.QuickTipManager.init();$$iPems.Tasks.noticeTask.start();$$iPems.Tasks.actAlmNoticeTask.start();var e=Ext.create("Ext.panel.Panel",{border:false,contentEl:"title-bar"});var b=Ext.create("Ext.panel.Panel",{border:false,contentEl:"page-body-content"});var d=Ext.create("Ext.panel.Panel",{region:"north",border:false,items:[e,b]});var a=Ext.create("Ext.container.Viewport",{id:"main-viewport",layout:"border",items:[{id:"top-nav-panel-fw",region:"north",contentEl:"top-nav-panel",height:51,border:false},{id:"left-nav-panel-fw",region:"west",title:"\u6211\u7684\u83dc\u5355",xtype:"treepanel",glyph:61457,width:220,split:true,collapsible:true,collapsed:false,autoScroll:true,useArrows:false,rootVisible:true,hidden:!$$iPems.menuVisible,margins:"5 0 5 5",contentEl:"left-nav-panel",bodyCls:"left-nav",store:new Ext.data.TreeStore({autoLoad:false,root:{id:-10078,text:"\u7cfb\u7edf\u4e3b\u9875",href:"/Home",icon:$$iPems.icons.Home,root:true},proxy:{type:"ajax",url:"/Home/GetNavMenus",reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"}}}),listeners:{render:function(f){f.getStore().load()},load:function(h,j,g,k){if(k){var i=this,f=h.getNodeById($$iPems.menuId);if(!Ext.isEmpty(f)){i.selectPath(f.getPath())}else{i.getRootNode().expand(false)}}}}},{id:"center-content-panel-fw",region:"center",layout:"border",contentEl:"center-content-panel",border:false,items:[d],padding:$$iPems.menuVisible?"5 5 5 0":5},{id:"bottom-speech-panel-fw",region:"south",height:0,border:false,layout:{type:"vbox",align:"stretch"},items:[Ext.create("Ext.ux.IFrame",{flex:1,loadMask:"\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...",src:"/Home/Speech"})]}]});var c=Ext.get("help-btn");if(!Ext.isEmpty(c)){c.on("click",function(f,i){var h=Ext.get("tip-arrow");if(Ext.isEmpty(h)){return false}var g=Ext.get("help-tip");if(Ext.isEmpty(g)){return false}g.setDisplayed(!g.isVisible());h.anchorTo(c,"tc-bc",[-2,1]);a.doLayout()})}Ext.getBody().setDisplayed(true)});
