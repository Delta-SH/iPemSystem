Ext.define("Ext.ux.Label",{extend:"Ext.form.Label",xtype:"iconlabel",requires:["Ext.XTemplate"],iconAlign:"left",baseCls:Ext.baseCSSPrefix+"label",renderTpl:["<tpl if=\"iconAlign == 'left'\">",'<img src="{[Ext.BLANK_IMAGE_URL]}" class="'+Ext.baseCSSPrefix+"label-icon",'<tpl if="!Ext.isEmpty(iconCls)"> {iconCls}</tpl>','"/>',"</tpl>",'<span class="'+Ext.baseCSSPrefix+'label-value">','<tpl if="!Ext.isEmpty(html)">{html}</tpl>',"</span>","<tpl if=\"iconAlign == 'right'\">",'<img src="{[Ext.BLANK_IMAGE_URL]}" class="'+Ext.baseCSSPrefix+"label-icon",'<tpl if="!Ext.isEmpty(iconCls)"> {iconCls}</tpl>','"/>',"</tpl>",],getElConfig:function(){var a=this;return Ext.apply(a.callParent(),{tag:"label",id:a.id,htmlFor:a.forId||""})},beforeRender:function(){var a=this;a.callParent();Ext.apply(a.renderData,{iconAlign:a.iconAlign,iconCls:a.iconCls||"",html:this.getDisplayText(a.text?a.text:a.html,!!a.text)});Ext.apply(a.renderSelectors,{imgEl:"."+Ext.baseCSSPrefix+"label-icon",textEl:"."+Ext.baseCSSPrefix+"label-value"});delete a.html},afterRender:function(){this.callParent(arguments);if(Ext.isEmpty(this.iconCls)){this.imgEl.setDisplayed(false)}if(this.editor){if(Ext.isEmpty(this.editor.field)){this.editor.field={xtype:"textfield"}}this.editor.target=this.textEl;this.editor=new Ext.Editor(this.editor)}},getContentTarget:function(){return this.textEl},getText:function(a){return this.rendered?a===true?Ext.util.Format.htmlEncode(this.textEl.dom.innerHTML):this.textEl.dom.innerHTML:this.text},getDisplayText:function(d,c){var b=d||this.text||this.html||"",a=c!==false?Ext.util.Format.htmlEncode(b):b;return(Ext.isEmpty(b)&&!Ext.isEmpty(this.emptyText))?this.emptyText:!Ext.isEmpty(this.format)?Ext.net.StringUtils.format(this.format,a):a},setText:function(b,a){a=a!==false;if(a){this.text=b;delete this.html}else{this.html=b;delete this.text}if(this.rendered){this.textEl.dom.innerHTML=this.getDisplayText(null,a);this.updateLayout()}return this},setIconCls:function(a){var b=this.iconCls;this.iconCls=a;if(this.rendered){this.imgEl.replaceCls(b,this.iconCls);this.imgEl.setDisplayed(!Ext.isEmpty(a))}},setTextWithIcon:function(c,a,b){this.setIconCls(a);this.setText(c,b)},append:function(b,a){this.setText([this.getText(),b,a===true?"<br/>":""].join(""),false)},appendLine:function(a){this.append(a,true)}});Ext.define("Ext.ux.MultiCombo",{extend:"Ext.form.field.ComboBox",xtype:"multicombo",selectionMode:"checkbox",storeUrl:null,idType:1,multiSelect:true,assertValue:function(){this.collapse()},getPicker:function(){if(!this.picker){this.listConfig=this.listConfig||{};if(!this.listConfig.getInnerTpl){this.listConfig.getInnerTpl=function(a){return'<div class="x-combo-list-item {[this.getItemClass(values)]}"><div class="x-mcombo-text">{'+a+"}</div></div>"}}this.listConfig.selModel={mode:"SIMPLE"};this.picker=this.createPicker();this.mon(this.picker.getSelectionModel(),"select",this.onListSelect,this);this.mon(this.picker.getSelectionModel(),"deselect",this.onListDeselect,this);this.picker.tpl.getItemClass=Ext.Function.bind(function(b){var a,d,c;if(this.selectionMode==="selection"){return""}Ext.each(this.store.getRange(),function(e){if(e.get(this.valueField)==b[this.valueField]){a=e;return false}},this);c=a?this.picker.getSelectionModel().isSelected(a):false;if(c){return"x-mcombo-item-checked"}return"x-mcombo-item-unchecked"},this,[],true);this.picker.on("viewready",this.onViewReady,this,{single:true})}return this.picker},onViewReady:function(){Ext.each(this.valueModels,function(a){this.selectRecord(a)},this)},onListSelect:function(b,a){if(!this.ignoreSelection){this.selectRecord(a)}},onListDeselect:function(b,a){if(!this.ignoreSelection){this.deselectRecord(a)}},initComponent:function(){var a=this;if(!Ext.isEmpty(a.storeUrl)){a.store=Ext.create("Ext.data.Store",{pageSize:1024,fields:[{name:"id",type:"auto"},{name:"text",type:"string"},{name:"comment",type:"string"}],proxy:{type:"ajax",url:a.storeUrl,reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"}}})}a.editable=false;a.callParent(arguments)},getDisplayValue:function(){var a=this.displayTpl.apply(this.displayTplData);return a},isSelected:function(a){if(Ext.isNumber(a)){a=this.store.getAt(a)}if(Ext.isString(a)){Ext.each(this.store.getRange(),function(b){if(b.get(this.valueField)==a){a=b;return false}},this)}return Ext.Array.indexOf(this.valueModels,a)!==-1},deselectRecord:function(a){if(!this.picker){return}switch(this.selectionMode){case"checkbox":this.picker.refreshNode(this.store.indexOf(a));break;case"selection":if(this.picker.getSelectionModel().isSelected(a)){this.picker.deselect(this.store.indexOf(a))}break;case"all":if(this.picker.getSelectionModel().isSelected(a)){this.picker.deselect(this.store.indexOf(a))}this.picker.refreshNode(this.store.indexOf(a));break}},selectRecord:function(a){if(!this.picker){return}switch(this.selectionMode){case"checkbox":this.picker.refreshNode(this.store.indexOf(a));break;case"selection":if(!this.picker.getSelectionModel().isSelected(a)){this.picker.select(this.store.indexOf(a),true)}break;case"all":if(!this.picker.getSelectionModel().isSelected(a)){this.picker.select(this.store.indexOf(a),true)}this.picker.refreshNode(this.store.indexOf(a));break}},selectAll:function(){this.setValue(this.store.getRange())},deselectItem:function(a){if(Ext.isNumber(a)){a=this.store.getAt(a)}if(Ext.isString(a)){Ext.each(this.store.getRange(),function(b){if(b.get(this.valueField)==a){a=b;return false}},this)}if(Ext.Array.indexOf(this.valueModels,a)!==-1){this.setValue(Ext.Array.remove(this.valueModels,a));this.deselectRecord(a)}},selectItem:function(a){if(Ext.isNumber(a)){a=this.store.getAt(a)}if(Ext.isString(a)){Ext.each(this.store.getRange(),function(b){if(b.get(this.valueField)==a){a=b;return false}},this)}if(Ext.Array.indexOf(this.valueModels,a)===-1){this.valueModels.push(a);this.setValue(this.valueModels)}},getSelectedRecords:function(){return this.valueModels},getSelectedIndexes:function(){var a=[];Ext.each(this.valueModels,function(b){a.push(this.store.indexOf(b))},this);return a},getSelectedValues:function(){var a=[];Ext.each(this.valueModels,function(b){a.push(b.get(this.valueField))},this);return a},getSelectedText:function(){var a=[];Ext.each(this.valueModels,function(b){a.push(b.get(this.displayField))},this);return a},getSelection:function(){var a=[];Ext.each(this.valueModels,function(b){a.push({text:b.get(this.displayField),value:b.get(this.valueField),index:this.store.indexOf(b)})},this);return a},setValue:function(b,a){this.callParent(arguments);Ext.each(this.valueModels,function(c){this.selectRecord(c)},this)},reset:function(){this.callParent(arguments);if(this.picker&&this.picker.rendered){this.picker.refresh()}},clearValue:function(){this.callParent(arguments);if(this.picker&&this.picker.rendered){this.picker.refresh()}}});Ext.define("Ext.ux.SingleCombo",{extend:"Ext.form.field.ComboBox",xtype:"singlecombo",storeUrl:null,initComponent:function(){var a=this;if(!Ext.isEmpty(a.storeUrl)){a.store=Ext.create("Ext.data.Store",{pageSize:1024,fields:[{name:"id",type:"int"},{name:"text",type:"string"},{name:"comment",type:"string"}],proxy:{type:"ajax",url:a.storeUrl,reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"}}})}a.callParent(arguments)}});Ext.define("Ext.ux.TreePicker",{extend:"Ext.form.field.Picker",requires:["Ext.tree.Panel"],xtype:"treepicker",triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",editable:false,multiSelect:false,delimiter:",",displayField:"text",pageSize:0,pickerHeight:300,minWidth:215,selectOnLeaf:false,rootVisible:false,searchVisible:false,remoteValues:[],queryDelay:300,storeUrl:null,searchUrl:null,queryUrl:null,searchChange:function(b,c,a){delete b._filterData;delete b._filterIndex},doRawSearch:function(g,h){var e=this;if(Ext.isEmpty(e.searchUrl)){return false}var c=e.getPicker(),f=e.findRoot(),b="/";if(Ext.isEmpty(h,false)){return}if(h.length<2){return}if(!c){return}if(g._filterData!=null&&g._filterIndex!=null){var d=g._filterIndex+1;var j=g._filterData;if(d>=j.length){d=0}var a=Ext.Array.from(j[d]);var i=Ext.String.format("{0}{1}{0}{2}",b,f.getId(),a.join(b));c.selectPath(i);g._filterIndex=d}else{Ext.Ajax.request({url:e.searchUrl,params:{text:h},mask:new Ext.LoadMask({target:c,msg:"\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e..."}),success:function(m,n){var o=Ext.decode(m.responseText,true);if(o.success){var k=o.data.length;if(k>0){var l=Ext.Array.from(o.data[0]);var p=Ext.String.format("{0}{1}{0}{2}",b,f.getId(),l.join(b));c.selectPath(p);g._filterData=o.data;g._filterIndex=0}}else{Ext.Msg.show({title:"\u7cfb\u7edf\u9519\u8bef",msg:o.message,buttons:Ext.Msg.OK,icon:Ext.Msg.ERROR})}}})}},doRawQuery:function(){var d=this;if(Ext.isEmpty(d.queryUrl)){return false}var c=d.getPicker(),b=d.remoteValues,e="/",a;Ext.Ajax.request({url:d.queryUrl,params:{nodes:b},success:function(f,g){var h=Ext.decode(f.responseText,true);if(h.success&&c){a=c.getRootNode();Ext.Array.each(h.data,function(k,i,j){k=Ext.Array.from(k);var l=Ext.String.format("{0}{1}{0}{2}",e,a.getId(),k.join(e));c.expandPath(l)})}}})},initComponent:function(){var a=this;if(!Ext.isEmpty(a.storeUrl)){a.store=Ext.create("Ext.data.TreeStore",{root:{id:"root",text:"\u5168\u90e8",icon:$$iPems.icons.Home,root:true},proxy:{type:"ajax",url:a.storeUrl,extraParams:{multiselect:a.multiSelect,leafselect:a.selectOnLeaf},reader:{type:"json",successProperty:"success",messageProperty:"message",totalProperty:"total",root:"data"}}})}a.mon(a.store,{load:a.onLoad,exception:a.onException,scope:a});this.addEvents("select","checkchange");if(!a.displayTpl){a.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : values["'+a.displayField+'"]]}<tpl if="xindex < xcount">'+a.delimiter+"</tpl></tpl>")}else{if(Ext.isString(a.displayTpl)){a.displayTpl=new Ext.XTemplate(a.displayTpl)}}a.callParent(arguments);a.doQueryTask=new Ext.util.DelayedTask(a.doRawQuery,a)},onException:function(){this.collapse()},onLoad:function(b,d,a,h){var f=this,c=f.picker,g=f.value;if(h&&g!=null){f.setValue(g);if(f.multiSelect===true){g=Ext.Array.from(g);if(d&&d.hasChildNodes()){d.eachChild(function(i){i.cascadeBy(function(k){var j=k.get("checked");if(j!==null){k.set("checked",Ext.Array.contains(g,k.data.id))}})})}}else{g=Ext.isArray(g)?g[0]:g;if(g){var e=f.findRecord(g);if(e){c.getSelectionModel().select(e)}}}}},createPicker:function(){var c=this;var b=c.search=Ext.create("Ext.form.field.Text",{emptyText:"\u8bf7\u8f93\u5165\u7b5b\u9009\u6761\u4ef6...",flex:1,listeners:{change:c.searchChange}});var d=Ext.create("Ext.button.Button",{glyph:61445,handler:function(f,g){var h=c.search.getRawValue();c.doRawSearch(c.search,h)}});var a=c.picker=Ext.create("Ext.tree.Panel",{shrinkWrapDock:2,floating:true,hidden:true,store:c.store,displayField:c.displayField,rootVisible:c.rootVisible,focusOnToFront:false,pageSize:c.pageSize,height:c.pickerHeight,minWidth:c.minWidth,shadow:false,viewConfig:{loadMask:true,preserveScrollOnRefresh:true},tbar:c.searchVisible?[b,d]:false});c.mon(a,{itemclick:c.onItemClick,checkchange:c.onCheckChange,scope:c});return a},getPicker:function(){var a=this;return a.picker||(a.picker=a.createPicker())},alignPicker:function(){var b=this,a=b.getPicker(),e=b.getPosition()[1]-Ext.getBody().getScroll().top,d=Ext.Element.getViewHeight()-e-b.getHeight(),c=Math.max(e,d);if(a.getHeight()>c-5){a.setHeight(c-5)}b.callParent()},resetPicker:function(){var c=this,b=c.picker;c.value=c.displayTplData=c.valueModels=null;if(b){if(!c.multiSelect){b.getSelectionModel().deselectAll()}else{var a=c.findRoot();if(a.hasChildNodes()){a.eachChild(function(d){d.cascadeBy(function(f){var e=f.get("checked");if(e!==null){f.set("checked",false)}})})}}}},onItemClick:function(b,a,f,h,g){var d=this,c=d.picker.getSelectionModel().getSelection();if(!d.multiSelect&&c.length){if(d.selectOnLeaf===true&&a.get("leaf")===false){return false}if(a.getId()===c[0].getId()){d.displayTplData=[a.data];d.setValue(a);d.setRawValue(d.getDisplayValue());d.collapse();d.inputEl.focus();d.fireEvent("select",d,a)}}},onCheckChange:function(d,c){var b=this,a=b.picker.getChecked();b.setValue(a,false);b.fireEvent("checkchange",b,a)},onExpand:function(){var d=this,b=d.picker,e=d.value;if(d.multiSelect===true){var a=b.getChecked();Ext.Array.each(a,function(h,g,f){b.selectPath(h.getPath())})}else{e=Ext.isArray(e)?e[0]:e;if(e){var c=d.findRecord(e);if(c){b.selectPath(c.getPath())}}}if(d.remoteValues.length>0){d.doQueryTask.delay(d.queryDelay)}Ext.defer(function(){d.picker.focus()},5)},onCollapse:function(){},findRecord:function(a){return this.store.getNodeById(a)},findRoot:function(){return this.store.getRootNode()},setValue:function(j){var g=this,k=g.inputEl,d,f,e,a,h=[],b=[],c=[];g.remoteValues=[];if(g.store.loading){g.value=j;return g}j=Ext.Array.from(j);for(d=0,f=j.length;d<f;d++){e=j[d];if(!e||!e.isModel){e=g.findRecord(e)}if(e){h.push(e);b.push(e.data);c.push(e.getId())}else{c.push(j[d]);a={};a[g.displayField]=j[d];b.push(a);g.remoteValues.push(j[d])}}g.value=g.multiSelect?c:c[0];if(!Ext.isDefined(g.value)){g.value=null}g.displayTplData=b;g.valueModels=h;if(k&&g.emptyText&&!Ext.isEmpty(j)){k.removeCls(g.emptyCls)}g.setRawValue(g.getDisplayValue());g.applyEmptyText();return g},getDisplayValue:function(){return this.displayTpl.apply(this.displayTplData)},getValue:function(){var b=this,a=b.picker,d=b.getRawValue(),c=b.value;if(b.getDisplayValue()!==d){c=d;b.resetPicker()}return c},getSubmitValue:function(){var a=this.getValue();return Ext.isEmpty(a)?"":a},clearValue:function(){this.setValue([])}});Ext.ux.DateTime=new function(){Ext.apply(this,{defaultFormat:"Y-m-d H:i:s",dateFormat:"Y-m-d",nowString:function(a){return Ext.Date.format(this.now(),a||this.defaultFormat)},todayString:function(a){return Ext.Date.format(this.today(),a||this.dateFormat)},now:function(){return new Date(Date.now())},today:function(){return Ext.Date.clearTime(this.now())},addSeconds:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.SECOND,c);return Ext.Date.format(a,d||this.defaultFormat)},addMinutes:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.MINUTE,c);return Ext.Date.format(a,d||this.defaultFormat)},addHours:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.HOUR,c);return Ext.Date.format(a,d||this.defaultFormat)},addDays:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.DAY,c);return Ext.Date.format(a,d||this.defaultFormat)},addMonths:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.MONTH,c);return Ext.Date.format(a,d||this.defaultFormat)},addYears:function(b,c,d){if(!Ext.isDate(b)){return null}var a=Ext.Date.add(b,Ext.Date.YEAR,c);return Ext.Date.format(a,d||this.defaultFormat)}})};Ext.define("Ext.ux.DateTimePicker",{extend:"Ext.form.field.Picker",xtype:"datetimepicker",format:"yyyy-MM-dd HH:mm:ss",editable:false,minDate:"1900-01-01 00:00:00",maxDate:"2099-12-31 23:59:59",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",onTriggerClick:function(){var a=this,b=a.inputEl;WdatePicker({el:b.id,dateFmt:a.format,isShowClear:false,isShowWeek:true,minDate:a.minDate,maxDate:a.maxDate})}});
/*
 * Ext JS Library 4.0
 * Copyright(c) 2006-2011 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.define("Ext.ux.IFrame",{extend:"Ext.Component",alias:"widget.uxiframe",loadMask:"Loading...",src:"about:blank",renderTpl:['<iframe src="{src}" name="{frameName}" width="100%" height="100%" frameborder="0"></iframe>'],initComponent:function(){this.callParent();this.frameName=this.frameName||this.id+"-frame";this.addEvents("beforeload","load");Ext.apply(this.renderSelectors,{iframeEl:"iframe"})},initEvents:function(){var a=this;a.callParent();a.iframeEl.on("load",a.onLoad,a)},initRenderData:function(){return Ext.apply(this.callParent(),{src:this.src,frameName:this.frameName})},getBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){try{return this.getWin().document}catch(a){return null}},getWin:function(){var b=this,a=b.frameName,c=Ext.isIE?b.iframeEl.dom.contentWindow:window.frames[a];return c},getFrame:function(){var a=this;return a.iframeEl.dom},beforeDestroy:function(){this.cleanupListeners(true);this.callParent()},cleanupListeners:function(c){var b,d;if(this.rendered){try{b=this.getDoc();if(b){Ext.EventManager.removeAll(b);if(c){for(d in b){if(b.hasOwnProperty&&b.hasOwnProperty(d)){delete b[d]}}}}}catch(a){}}},onLoad:function(){var b=this,d=b.getDoc(),a=b.onRelayedEvent;if(d){try{Ext.EventManager.removeAll(d);Ext.EventManager.on(d,{mousedown:a,mousemove:a,mouseup:a,click:a,dblclick:a,scope:b})}catch(c){}Ext.EventManager.on(this.getWin(),"beforeunload",b.cleanupListeners,b);this.el.unmask();this.fireEvent("load",this)}else{if(b.src&&b.src!=""){this.el.unmask();this.fireEvent("error",this)}}},onRelayedEvent:function(c){var b=this.iframeEl,d=Ext.Element.getTrueXY(b),e=c.getXY(),a=Ext.EventManager.getPageXY(c.browserEvent);c.xy=[d[0]+a[0],d[1]+a[1]];c.injectEvent(b);c.xy=e},load:function(d){var a=this,c=a.loadMask,b=a.getFrame();if(a.fireEvent("beforeload",a,d)!==false){if(c&&a.el){a.el.mask(c)}b.src=a.src=(d||a.src)}}});
